<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ZiGma</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.zigma.cc/"/>
  <updated>2018-07-21T15:07:20.213Z</updated>
  <id>http://www.zigma.cc/</id>
  
  <author>
    <name>ZiGma</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>【JsBox】Light Store第三方轻量商店</title>
    <link href="http://www.zigma.cc/2018/07/21/%E3%80%90JsBox%E3%80%91Light-Store%E7%AC%AC%E4%B8%89%E6%96%B9%E8%BD%BB%E9%87%8F%E5%95%86%E5%BA%97/"/>
    <id>http://www.zigma.cc/2018/07/21/【JsBox】Light-Store第三方轻量商店/</id>
    <published>2018-07-20T17:11:35.000Z</published>
    <updated>2018-07-21T15:07:20.213Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>JsBox脚本分发有点麻烦，除了TG群分享和社区发帖似乎没有别的途径，所以最近断断续续写了一个JsBox的三方轻量商店。（虽然还没写完的时候，钟大开始推出了官方商店投稿）</p><p>这是第一个测试版，仅在7/7P机型上测试，X和SE等机型还未测试，欢迎反馈。</p><ul><li>如果报错”未找到变量”，请关闭严格模式。</li></ul><h1 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h1><p>此项目收录的脚本，除了一些自己写的，其余均来自与社区或者TG群，亦会标注原作者及原帖地址，如果脚本作者认为有版权或者其他问题的，请及时联系我们进行删除。</p><h1 id="预览"><a href="#预览" class="headerlink" title="预览"></a>预览</h1><p><img src="http://zigma.qiniudn.com//lightstore/ls1.jpg" alt="1"></p><p><img src="http://zigma.qiniudn.com//lightstore/ls2.jpg" alt="2"></p><p><img src="http://zigma.qiniudn.com//lightstore/ls3.jpg" alt="3"></p><p><img src="http://zigma.qiniudn.com//lightstore/ls4.jpg" alt="4"></p><p><img src="http://zigma.qiniudn.com//lightstore/ls5.jpg" alt="5"></p><p><img src="http://zigma.qiniudn.com//lightstore/ls6.jpg" alt="6"></p><p><img src="http://zigma.qiniudn.com//lightstore/ls7.jpg" alt="7"></p><p><img src="http://zigma.qiniudn.com//lightstore/ls8.jpg" alt="8"></p><h1 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h1><p><a href="https://xteko.com/redir?name=Light%20Store&amp;url=https%3A%2F%2Fraw.githubusercontent.com%2FZiGmaX809%2FJsBoxLib%2Fmaster%2FLight_Store%2FLight%2520Store.box" target="_blank" rel="noopener">Light Store</a></p><h1 id="更新记录"><a href="#更新记录" class="headerlink" title="更新记录"></a>更新记录</h1><p>#2018/7/21 </p><p>V1.0.1 更新部分相关更新。</p><p>V1.0.2 增加双击首页回到页首功能；详情页原帖地址按钮底色修改。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;JsBox脚本分发有点麻烦，除了TG群分享和社区发帖似乎没有别的途径，所以最近断断续续写了一个JsBox的三方轻量商店。（虽然还没写完的时候
      
    
    </summary>
    
    
      <category term="JsBox" scheme="http://www.zigma.cc/tags/JsBox/"/>
    
  </entry>
  
  <entry>
    <title>【Hexo】从Wordpress转Hexo的那些深坑</title>
    <link href="http://www.zigma.cc/2018/06/27/%E3%80%90Hexo%E3%80%91%E4%BB%8EWordpress%E8%BD%ACHexo%E7%9A%84%E9%82%A3%E4%BA%9B%E6%B7%B1%E5%9D%91/"/>
    <id>http://www.zigma.cc/2018/06/27/【Hexo】从Wordpress转Hexo的那些深坑/</id>
    <published>2018-06-27T14:44:12.000Z</published>
    <updated>2018-06-28T10:21:23.373Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>昨天作死开始了从wp到Hexo的迁移之旅，网上大部分Hexo搭建教程都还停留在2017年甚至2016年，所以整个迁移过程历尽深坑不断。</p><p>因此我觉得有必要记录一下自己所踩过的那些深坑。</p><p>具体有以下几点：</p><ul><li>搬瓦工ssh端口；</li><li>ssh公钥和秘钥问题；</li><li>VPS文件/文件夹权限问题；</li><li>post-receive钩子无法正常执行的问题；</li></ul><p>主要参考：</p><p><a href="http://skyhacks.org/2017/07/21/UseHexoToBuildBlog/" target="_blank" rel="noopener">Hexo环境搭建个人博客</a></p><p><a href="https://calton007.github.io/2018/05/08/n-deploy-vps/" target="_blank" rel="noopener">使用 Git Hook 自动部署 Hexo 到个人 VPS </a></p><h1 id="填坑开始"><a href="#填坑开始" class="headerlink" title="填坑开始"></a>填坑开始</h1><p>Hexo的基本运行逻辑就是本地编写Markdown文档——利用Git生成html页面——利用Git推送到VPS——VPS再通过Git钩子发布到Nignx配置文件夹发布。</p><h2 id="一、本地环境搭建"><a href="#一、本地环境搭建" class="headerlink" title="一、本地环境搭建"></a>一、本地环境搭建</h2><h3 id="安装node-js"><a href="#安装node-js" class="headerlink" title="安装node.js"></a>安装node.js</h3><p>在<a href="https://nodejs.org/en/download/" target="_blank" rel="noopener">Node.js</a>官网下载对应版本一路next安装即可。</p><h3 id="安装Git环境"><a href="#安装Git环境" class="headerlink" title="安装Git环境"></a>安装Git环境</h3><p>同样在<a href="https://git-scm.com/download/win" target="_blank" rel="noopener">Git For Windows</a>下载后一路next安装。</p><p>根据前述参考文章是需要<a href="http://www.brafox.com/post/2015/%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/git-%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE.html" target="_blank" rel="noopener">配置环境变量</a>的，但是我本地的Git是因为VS Code才安装的，并没有设置环境变量。虽然也能用但是无法排除本文所提的深坑是因此而出现，所以还是建议配置一下。</p><p>安装完Git，需要生成ssh密钥，但是我们先要设置Git用户名，从开始菜单中运行Git Bash。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name "你的用户名"</span><br><span class="line">git config --global user.email "你的邮箱地址"</span><br></pre></td></tr></table></figure><p>设置完成后继续生成ssh密钥</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C "你的邮箱地址"</span><br></pre></td></tr></table></figure><p>完成后打开目录<code>C:\Users\XXX\.ssh\</code>内的<code>id_rsa.pub</code>文件备用。</p><h3 id="创建本地目录"><a href="#创建本地目录" class="headerlink" title="创建本地目录"></a>创建本地目录</h3><p>在电脑任意位置创建文件夹作为本地目录用以写作，例如我就是以<code>D:\Hexo\</code>为本地目录。</p><p>在此目录下右键点击<code>Git Bash Here</code>后<strong>分别执行</strong>以下命令以安装Hexo：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br><span class="line">hexo init</span><br><span class="line">npm install</span><br><span class="line">hexo d -fg</span><br></pre></td></tr></table></figure><p>完成后可以在<code>D:\Hexo\</code>目录下看到已有本地文件生成，继续在Git命令窗口输入<code>hexo s</code>运行本地服务器，看到提示有<code>http://localhost:4000</code>后在浏览器打开该地址已验证本地是否部署成功。</p><h2 id="二、VPS环境部署"><a href="#二、VPS环境部署" class="headerlink" title="二、VPS环境部署"></a>二、VPS环境部署</h2><p>VPS系统我选择的是Centos 7，因为发现Centos 6安装Nginx十分复杂。</p><h3 id="1、安装Nginx"><a href="#1、安装Nginx" class="headerlink" title="1、安装Nginx"></a>1、安装Nginx</h3><h4 id="·-添加Nginx到YUM源"><a href="#·-添加Nginx到YUM源" class="headerlink" title="· 添加Nginx到YUM源"></a>· 添加Nginx到YUM源</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm</span><br></pre></td></tr></table></figure><h4 id="·-安装Nginx"><a href="#·-安装Nginx" class="headerlink" title="· 安装Nginx"></a>· 安装Nginx</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y nginx</span><br></pre></td></tr></table></figure><h4 id="·-配置Nginx"><a href="#·-配置Nginx" class="headerlink" title="· 配置Nginx"></a>· 配置Nginx</h4><p>利用</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/nginx/conf.d/default.conf</span><br></pre></td></tr></table></figure><p>编辑<code>default.conf</code>文件，插入如下代码（需要自行更改<code>server_name example.com www.example.com;</code>，其他的路径可以不改动）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80 ;</span><br><span class="line">    root /var/www/hexo; //这里可以改成你的网站目录地址，我将网站放在/var/www/hexo</span><br><span class="line">    server_name example.com www.example.com; //这里输入你的域名或IP地址</span><br><span class="line">    access_log  /var/log/nginx/hexo_access.log; //这里的log文件也可以根据自己网站名字替换</span><br><span class="line">    error_log   /var/log/nginx/hexo_error.log; //这里的log文件也可以根据自己网站名字替换</span><br><span class="line">    location ~* ^.+\.(ico|gif|jpg|jpeg|png)$ &#123;</span><br><span class="line">            root /var/www/hexo; //网站目录地址</span><br><span class="line">            access_log   off;</span><br><span class="line">            expires      1d;</span><br><span class="line">    &#125;</span><br><span class="line">    location ~* ^.+\.(css|js|txt|xml|swf|wav)$ &#123;</span><br><span class="line">        root /var/www/hexo; //网站目录地址</span><br><span class="line">        access_log   off;</span><br><span class="line">        expires      10m;</span><br><span class="line">    &#125;</span><br><span class="line">    location / &#123;</span><br><span class="line">        root /var/www/hexo; //网站目录地址</span><br><span class="line">        if (-f $request_filename) &#123;</span><br><span class="line">            rewrite ^/(.*)$  /$1 break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后利用<code>service nginx restart</code>重启Nginx服务。</p><h3 id="2、安装Git"><a href="#2、安装Git" class="headerlink" title="2、安装Git"></a>2、安装Git</h3><p>利用以下代码安装Git</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum update &amp;&amp; apt-get upgrade -y #更新内核</span><br><span class="line">yum install git-core</span><br></pre></td></tr></table></figure><h3 id="3、新建git用户并添加sudo权限"><a href="#3、新建git用户并添加sudo权限" class="headerlink" title="3、新建git用户并添加sudo权限"></a>3、新建git用户并添加sudo权限</h3><p>分别利用以下命令新建git用户、给<code>sudoers</code>文件提权、编辑。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">adduser git</span><br><span class="line">chmod 740 /etc/sudoers #改变权限值用于读写</span><br><span class="line">vi /etc/sudoers</span><br></pre></td></tr></table></figure><p>找到</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span># Allow root to run any commands anywhere</span><br><span class="line">root   ALL=(ALL)   ALL</span><br></pre></td></tr></table></figure><p>后在之后添加以下代码并保存。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git    ALL=(ALL)   ALL</span><br></pre></td></tr></table></figure><p>随后再将<code>sudoers</code>文件改回原来的权限</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 440 /etc/sudoers</span><br></pre></td></tr></table></figure><h3 id="4、配置ssh登录"><a href="#4、配置ssh登录" class="headerlink" title="4、配置ssh登录"></a>4、配置ssh登录</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su git</span><br></pre></td></tr></table></figure><p>切换为git用户</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">mkdir .ssh &amp;&amp; cd .ssh</span><br><span class="line">touch authorized_keys</span><br><span class="line">vi authorized_keys // 在这个文件中粘贴进刚刚Winodws下申请的key（在id_rsa.pub文件中）</span><br></pre></td></tr></table></figure><p>因为搬瓦工的ssh端口是随机的，但是git默认使用22端口，我测试在本地修改config文件更换git通讯端口，但是效果并不好，所以我们需要将搬瓦工的ssh端口改回22，并且打开免密登录。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/ssh/sshd.config</span><br></pre></td></tr></table></figure><p>找到以下代码前的#并删除。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">RSAAuthentication yes</span><br><span class="line">PubkeyAuthentication yes</span><br></pre></td></tr></table></figure><p>并将最后的<code>Port xxxxx</code>改为<code>Port 22</code>。</p><p>最后！！！</p><p>需要设置.ssh文件夹和authorized_keys文件的权限，分别设置为700和600，不然永远无法push代码到服务器，这个坑足足坑了我一天。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">chmod 700 .ssh</span><br><span class="line">cd .ssh</span><br><span class="line">chmod 600 authorized_keys</span><br></pre></td></tr></table></figure><p>现在你可以在Git Bash使用<code>ssh git@你的VPS IP地址</code>测试能否登录，如果可以则代表前三个坑已经填完。</p><h3 id="5、初始化git仓库"><a href="#5、初始化git仓库" class="headerlink" title="5、初始化git仓库"></a>5、初始化git仓库</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">mkdir hexo.git &amp;&amp; cd hexo.git</span><br><span class="line">git init --bare</span><br></pre></td></tr></table></figure><p>等待初始化完毕后，再创建网站目录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /var/www</span><br><span class="line">mkdir hexo</span><br><span class="line">chown git:git -R /var/www/hexo</span><br></pre></td></tr></table></figure><h4 id="配置Git-Hooks"><a href="#配置Git-Hooks" class="headerlink" title="配置Git Hooks"></a>配置Git Hooks</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">su git</span><br><span class="line">cd /home/git/hexo.git/hooks # 如果没有hooks目录,就mkdir hooks 自己建一个目录</span><br><span class="line">vi post-receive</span><br></pre></td></tr></table></figure><p>输入以下代码</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git --work-tree=/var/www/hexo --git-dir=/home/git/hexo.git checkout -f</span><br></pre></td></tr></table></figure><p>这里是最后一个坑，因为Hexo版本的更新，旧版的<code>post-receive</code>无效，所以需要用新方法。</p><p>然后赋予<code>post-receive</code>文件执行权限。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x post-receive</span><br></pre></td></tr></table></figure><p>最后将<code>hexo.git目录</code>所有权设置为git。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /home/git</span><br><span class="line">chown -R git:git hexo.git</span><br></pre></td></tr></table></figure><p>至此服务端配置完毕。</p><h2 id="三、Hexo配置"><a href="#三、Hexo配置" class="headerlink" title="三、Hexo配置"></a>三、Hexo配置</h2><p>修改 hexo 目录下的 <code>_config.yml</code> 文件，找到 <code>[deploy]</code> 条目，并修改为 </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">      type: git</span><br><span class="line">      repo: git@服务器地址:/home/git/hexo.git</span><br><span class="line">      branch: master</span><br></pre></td></tr></table></figure><p>至此，Hexo配置完毕，最后在本地<code>D:\Hexo</code>文件夹右键<code>Git Bash Here</code>运行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><p>安装git的push插件，完成后再利用</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo g &amp;&amp; hexo d</span><br></pre></td></tr></table></figure><p>将本地目录生成静态网页并推送到VPS。</p><p>齐活。</p><h1 id="结束语"><a href="#结束语" class="headerlink" title="结束语"></a>结束语</h1><p>鉴于本文并不是在解决问题时撰写，而是成功后根据回忆和参考教程所写，因此在实际操作过程中会有一定出入，如有错误欢迎指正。</p><p>希望本文给折腾的你提供些许参考，而不是重复造轮子。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;昨天作死开始了从wp到Hexo的迁移之旅，网上大部分Hexo搭建教程都还停留在2017年甚至2016年，所以整个迁移过程历尽深坑不断。&lt;/p
      
    
    </summary>
    
    
      <category term="VPS" scheme="http://www.zigma.cc/tags/VPS/"/>
    
      <category term="Hexo" scheme="http://www.zigma.cc/tags/Hexo/"/>
    
      <category term="搬瓦工" scheme="http://www.zigma.cc/tags/%E6%90%AC%E7%93%A6%E5%B7%A5/"/>
    
  </entry>
  
  <entry>
    <title>【JsBox】超轻量级Aria2客户端</title>
    <link href="http://www.zigma.cc/2018/06/26/%E3%80%90JsBox%E3%80%91%E8%B6%85%E8%BD%BB%E9%87%8F%E7%BA%A7Aria2%E5%AE%A2%E6%88%B7%E7%AB%AF/"/>
    <id>http://www.zigma.cc/2018/06/26/【JsBox】超轻量级Aria2客户端/</id>
    <published>2018-06-26T15:40:07.000Z</published>
    <updated>2018-06-27T12:51:50.809Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>说是客户端，其实只有添加任务的功能。<br>不过即使是网页客户端，设置后重启也会重置，所以Aria2设置还是编辑conf文件比较妥当。<br>之前通过AriaNG提供的api写过一个类似脚本，但是没有设置界面，每次添加会有网页弹窗。<br>所以这次利用jsonrpc重写了一个。</p><h2 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h2><ul><li>主应用界面是设置，填入rpc地址与token，完成后可以激活测试连接是否正确。</li><li>分享面板和启动器均是添加任务。分享面板会直接添加选取的链接，为了保证进入主界面是设置界面，所以将粘贴板链接读取放在了启动器中。</li><li>如何添加和设置Aria2下载端请Google，梅林可以参考我的另一篇博文<a href="http://www.zigma.cc/2018/05/17/%E3%80%90%E7%9E%8E%E6%8A%98%E8%85%BE%E3%80%91%E6%A2%85%E6%9E%97%E5%9B%BA%E4%BB%B6%E5%88%A9%E7%94%A8entware%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85Aria2/">【瞎折腾】梅林固件利用entware环境安装Aria2</a>。</li></ul><h2 id="截图"><a href="#截图" class="headerlink" title="截图"></a>截图</h2><p><img src="http://p3f4nvcby.bkt.clouddn.com//aria2/1.jpg" alt="p1"><br><img src="http://p3f4nvcby.bkt.clouddn.com//aria2/2.jpg" alt="p2"></p><h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><p><a href="https://xteko.com/redir?name=Aria2&amp;url=https%3A%2F%2Fraw.githubusercontent.com%2FZiGmaX809%2FJsBoxLib%2Fmaster%2FAria2%2FAria2.box" target="_blank" rel="noopener">Aria2</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;说是客户端，其实只有添加任务的功能。&lt;br&gt;不过即使是网页客户端，设置后重启也会重置，所以Aria2设置还是编辑conf文件比较妥当。&lt;br
      
    
    </summary>
    
      <category term="JsBox" scheme="http://www.zigma.cc/categories/JsBox/"/>
    
    
      <category term="JsBox" scheme="http://www.zigma.cc/tags/JsBox/"/>
    
  </entry>
  
  <entry>
    <title>【JsBox】Palette 调色板</title>
    <link href="http://www.zigma.cc/2018/06/26/%E3%80%90JsBox%E3%80%91Palette-%E8%B0%83%E8%89%B2%E6%9D%BF/"/>
    <id>http://www.zigma.cc/2018/06/26/【JsBox】Palette-调色板/</id>
    <published>2018-06-26T15:24:22.000Z</published>
    <updated>2018-06-26T15:38:29.343Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>之前写Days Pro时想要找几个配色，在App Store找了一圈相关的App，但是这类工具数量少的可怜，并且交互十分不友好，比如无法复制HEX、RGB值，再或者界面并未适配7P。</p><p>所以就按照其中比较好的一款写了个脚本，并且支持了直接复制颜色值，之前设计是想要支持查看历史记录的，但是在实际实现过程中，发现这个功能并不常用。而且如果实现这个比较鸡肋的功能，还要增加大量计算，权衡之下放弃了这个功能，当然也有可能是我水平不够，数据传导结构没做好。按照目前来看，现有日常使用已经绰绰有余。</p><p>选取图片颜色因为JsBox现在暂时还不支持触摸的动作，本人能力也有限，所以本项目不在考虑范围内。</p><h1 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h1><p>· 点击HEX和RGB值可以直接复制所显示的内容，包括#和()；<br>· 各条Slider都会随着数据变化而变化，因此RGB标签页想要查看颜色更加直观。</p><h1 id="安装链接"><a href="#安装链接" class="headerlink" title="安装链接"></a>安装链接</h1><p><a href="https://xteko.com/redir?name=Palette&amp;url=https%3A%2F%2Fraw.githubusercontent.com%2FZiGmaX809%2FJsBoxLib%2Fmaster%2FPalette%2FPalette.box" target="_blank" rel="noopener">Palette</a></p><h1 id="截图"><a href="#截图" class="headerlink" title="截图"></a>截图</h1><p><img src="http://p3f4nvcby.bkt.clouddn.com//palette/IMG_5840.png" alt="1" title="1"><br><img src="http://p3f4nvcby.bkt.clouddn.com//palette/IMG_5841.png" alt="2" title="2"><br><img src="http://p3f4nvcby.bkt.clouddn.com//palette/IMG_5842.png" alt="3" title="3"></p><h1 id="更新记录"><a href="#更新记录" class="headerlink" title="更新记录"></a>更新记录</h1><p>2018/6/3 V1.0.2 修复大量BUG</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;之前写Days Pro时想要找几个配色，在App Store找了一圈相关的App，但是这类工具数量少的可怜，并且交互十分不友好，比如无法复制
      
    
    </summary>
    
      <category term="JsBox" scheme="http://www.zigma.cc/categories/JsBox/"/>
    
    
      <category term="JsBox" scheme="http://www.zigma.cc/tags/JsBox/"/>
    
  </entry>
  
  <entry>
    <title>【JsBox】Days Pro</title>
    <link href="http://www.zigma.cc/2018/06/22/%E3%80%90JsBox%E3%80%91Days%20Pro/"/>
    <id>http://www.zigma.cc/2018/06/22/【JsBox】Days Pro/</id>
    <published>2018-06-22T15:01:15.000Z</published>
    <updated>2018-06-27T12:53:14.330Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>之前想填的倒数日的坑终于填了。 仿自”倒数日 Days”。  </p><p>理论可以计算到无限天数，但是超过5位数的天数背景会错乱（懒得适配）。 </p><ul><li>支持主题选择。 </li><li>主应用运行是设置，小组件运行是倒数界面。</li></ul><h2 id="截图"><a href="#截图" class="headerlink" title="截图"></a>截图</h2><p><img src="http://zigma.qiniudn.com//dayspro/1.jpg" alt="1" title="1"> <img src="http://p3f4nvcby.bkt.clouddn.com//days/2.jpg" alt="2" title="2"></p><h2 id="安装链接"><a href="#安装链接" class="headerlink" title="安装链接"></a>安装链接</h2><p><a href="https://xteko.com/redir?name=Days%20Pro&amp;url=https%3A%2F%2Fraw.githubusercontent.com%2FZiGmaX809%2FJsBoxLib%2Fmaster%2FDays_Pro%2FDays%2520Pro.box" title="Days_Pro" target="_blank" rel="noopener">Days_Pro</a></p><h2 id="更新记录"><a href="#更新记录" class="headerlink" title="更新记录"></a>更新记录</h2><p>2018/6/5 1.0.2<br>· 增加节假日模式、多色彩主题自定义；<br>· Bug修复。<br>2018/6/12 1.0.3<br>· 调整对emoji字符长度识别以优化长度限制；<br>· 调整主题选择；<br>· 调整到达事件当天显示方式。<br>2018/6/22 1.0.4<br>· 修正节假日模式到达假日当天显示方式。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;之前想填的倒数日的坑终于填了。 仿自”倒数日 Days”。  &lt;/p&gt;
&lt;p&gt;理论可以计算到无限天数，但是超过5位数的天数背景会错乱（懒得适
      
    
    </summary>
    
      <category term="JsBox" scheme="http://www.zigma.cc/categories/JsBox/"/>
    
    
      <category term="JsBox" scheme="http://www.zigma.cc/tags/JsBox/"/>
    
  </entry>
  
  <entry>
    <title>【JsBox】SysInfo Pro</title>
    <link href="http://www.zigma.cc/2018/05/26/%E3%80%90JsBox%E3%80%91SysInfo%20Pro/"/>
    <id>http://www.zigma.cc/2018/05/26/【JsBox】SysInfo Pro/</id>
    <published>2018-05-26T13:06:32.000Z</published>
    <updated>2018-06-27T12:49:05.719Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>根据之前TG群的Netspeed（找不到作者了）和RYAN大佬的Progress按照App——SYS PRO制作。 </p><p>可以查看当前网速、局域网外网IP、设备名称、iOS版本、磁盘剩余、内存占用等情况。 可以点击界面来切换显示的系统信息和网络信息。 </p><p>目前已知的问题： </p><ol><li>硬盘剩余与实际不符； </li><li>内存占用可能也存在同样的情况，但是总体差不多，没1那么夸张； </li><li>内存占用的百分比在某些情况下会出现N多位小数。</li></ol><h2 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h2><p><del>（三条都不是我的锅）</del>，对不起第三条的确是我的锅。 1和2的问题，是JsBox的返回值就是这样，可以自行利用</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ui.alert($device.space)</span><br></pre></td></tr></table></figure><p>查看。 </p><p><del>3的问题仅会偶尔在刚启动出现一下，暂时找不到原因，不影响使用。</del></p><p>会经常出现，已经修复。</p><h2 id="附安装地址"><a href="#附安装地址" class="headerlink" title="附安装地址"></a>附安装地址</h2><p><a href="http://zigma.qiniudn.com//js/s1/SysInfo%20Pro.box" title="SysInfo Pro" target="_blank" rel="noopener">SysInfo Pro</a></p><h2 id="附图"><a href="#附图" class="headerlink" title="附图"></a>附图</h2><p><img src="http://p3f4nvcby.bkt.clouddn.com//sysinfo/1%20%282%29.jpg" alt=""> <img src="http://p3f4nvcby.bkt.clouddn.com//sysinfo/1%20%283%29.jpg" alt=""> <img src="http://p3f4nvcby.bkt.clouddn.com//sysinfo/1%20%284%29.jpg" alt=""> <img src="http://p3f4nvcby.bkt.clouddn.com//sysinfo/1%20%281%29.jpg" alt=""></p><h2 id="更新记录"><a href="#更新记录" class="headerlink" title="更新记录"></a>更新记录</h2><p>2018/5/26更新1.0.1 修复出现NNNNN多小数点的问题。 </p><p>2018/5/27更新1.0.2 限制SSID长度以解决字符叠加。 </p><p>2018/5/27更新1.0.3 修复外网IP偶尔的排版错误。 </p><p>2018/6/12更新1.0.4 适配SE机型，以及其他机型适配优化。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;根据之前TG群的Netspeed（找不到作者了）和RYAN大佬的Progress按照App——SYS PRO制作。 &lt;/p&gt;
&lt;p&gt;可以查看
      
    
    </summary>
    
      <category term="JsBox" scheme="http://www.zigma.cc/categories/JsBox/"/>
    
    
      <category term="JsBox" scheme="http://www.zigma.cc/tags/JsBox/"/>
    
  </entry>
  
  <entry>
    <title>【瞎折腾】梅林固件利用entware环境安装Aria2</title>
    <link href="http://www.zigma.cc/2018/05/17/%E3%80%90%E7%9E%8E%E6%8A%98%E8%85%BE%E3%80%91%E6%A2%85%E6%9E%97%E5%9B%BA%E4%BB%B6%E5%88%A9%E7%94%A8entware%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85Aria2/"/>
    <id>http://www.zigma.cc/2018/05/17/【瞎折腾】梅林固件利用entware环境安装Aria2/</id>
    <published>2018-05-17T11:53:02.000Z</published>
    <updated>2018-06-27T12:56:40.823Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>之前折腾了一下小宝固件软件中心的Aria2，安装是方便了，但是问题也不少。</p><ul><li><p>Bug不少，经常莫名其妙假死。</p></li><li><p>添加设置需要在面板进行，如果是改conf文件，面板里面一提交，conf就会被重写。 </p></li><li><p>第二点就导致了自动更新tarcker列表的脚本无法执行。 </p></li><li><p>更新需要等待适配。</p></li></ul><p>今天看论坛有大佬编译了1.34的版本，所以就想舍弃软件中心版，直接自己安装。 虽然看不到了面板那么详细的数据，但是总体还不错。</p><h1 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h1><h2 id="自动挂载U盘"><a href="#自动挂载U盘" class="headerlink" title="自动挂载U盘"></a>自动挂载U盘</h2><p>因为之前直接安装Aria2到路由，运行一段时间重启后会导致opt文件夹软链丢失，造成Aria2无法启动和运行。所以想用其他方法，然后看到了<a href="https://blog.bluerain.io/p/AsusWrt-Merlin.html" title="这篇文章" target="_blank" rel="noopener">这篇文章</a>，将opt文件夹链接到U盘，运行了一天十分稳定，重启后也不会丢失opt文件夹。 插上U盘，执行 df 命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ZiGma@RT-AC86U-8450:/tmp/home/root# df</span><br><span class="line">Filesystem           1K-blocks      Used Available Use% Mounted on</span><br><span class="line">ubi:rootfs_ubifs         79016     56648     22368  72% /</span><br><span class="line">mtd:bootfs                4480      3348      1132  75% /bootfs</span><br><span class="line">mtd:data                  8192       624      7568   8% /data</span><br><span class="line">/dev/mtdblock8           49152     18256     30896  37% /jffs</span><br><span class="line">/dev/sda1              7315130         5   6920322   0% /tmp/mnt/sda1</span><br><span class="line">/dev/sda             488384508 100183552 388200956  21% /tmp/mnt/Disk</span><br></pre></td></tr></table></figure><p>可以看到U盘路径是/tmp/mnt/sda1。 所以直接运行以下代码进行挂载。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt; EOF &gt; /tmp/script_usbmount.tmp</span><br><span class="line">if [ \$1 = "/tmp/mnt/sda1" ]</span><br><span class="line">then</span><br><span class="line">ln -sf \$1 /tmp/opt</span><br><span class="line">/opt/etc/init.d/rc.unslung start</span><br><span class="line">fi</span><br><span class="line">EOF</span><br><span class="line">nvram set script_usbmount="`cat /tmp/script_usbmount.tmp`"</span><br><span class="line">cat &lt;&lt; EOF &gt; /tmp/script_usbumount.tmp</span><br><span class="line">if [ \$1 = "/tmp/mnt/sda1" ]</span><br><span class="line">then</span><br><span class="line">/opt/etc/init.d/rc.unslung stop</span><br><span class="line">fi</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><p>继续执行以下代码后重启。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nvram set script_usbumount="`cat /tmp/script_usbumount.tmp`"</span><br><span class="line">nvram commit</span><br></pre></td></tr></table></figure><h2 id="绑定挂载U盘"><a href="#绑定挂载U盘" class="headerlink" title="绑定挂载U盘"></a>绑定挂载U盘</h2><p>使用过程中，重启之后发现Aria2没有运行，查看了进程也无法找到，也无法使用命令启动。 查了一下才发现U盘挂载点已经变成了/tmp/mnt/sdb1，所以要将U盘固定到盘符。 先利用</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">blkid</span><br></pre></td></tr></table></figure><p>查看已经挂载的所有硬盘的UUID。 可以看到</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/dev/sda1: UUID="e5fff8c8-c1f1-d301-60ff-f8c8c1f1d301"</span><br><span class="line">/dev/sdb: LABEL="Disk" UUID="528629456341BE39"</span><br></pre></td></tr></table></figure><p>需要注意的是要在正常挂载的情况下操作。 然后编辑/etc/fstab文件，添加：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UUID=e5fff8c8-c1f1-d301-60ff-f8c8c1f1d301 /dev/sda1 ext4 defaults 0 0</span><br></pre></td></tr></table></figure><p>说明一下字段意义： - UUID - 挂载位置 - 格式 - 挂载参数（具体参考mount -o命令选项） - 是否需要dump备份 - 系统启动时进行磁盘检查的顺序</p><h2 id="安装entware环境"><a href="#安装entware环境" class="headerlink" title="安装entware环境"></a>安装entware环境</h2><p>将entware环境安装到上述的U盘中。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">entware-setup.sh</span><br></pre></td></tr></table></figure><p>安装完成后可以用cd /opt/查看，一般来讲是可以看到U盘目录，继续用</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">opkg update</span><br></pre></td></tr></table></figure><p>更新仓库索引到本地。</p><h2 id="安装虚拟内存"><a href="#安装虚拟内存" class="headerlink" title="安装虚拟内存"></a>安装虚拟内存</h2><p>因为在查找原因时，有反应说软件中心的虚拟内存和entware环境下的Aria2有冲突，所以虚拟内存在这里进行安装。 依次执行<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dd if=/dev/zero of=/tmp/mnt/sda1/swapfile bs=1024 count=512000</span><br></pre></td></tr></table></figure></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkswap /tmp/mnt/sda1/swapfile</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">swapon /tmp/mnt/sda1/swapfile</span><br></pre></td></tr></table></figure><p>创建启动脚本</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">echo '</span><br><span class="line"><span class="meta">#</span>!/bin/sh</span><br><span class="line"><span class="meta">#</span> Turn On Usage Of Swapfile</span><br><span class="line">if [ -f "/tmp/mnt/sda1/swapfile" ];then</span><br><span class="line">swapon /tmp/mnt/sda1/swapfile</span><br><span class="line">echo "Turning Swapfile On"</span><br><span class="line">fi</span><br><span class="line">' &gt;&gt; /jffs/scripts/post-mount</span><br></pre></td></tr></table></figure><h2 id="安装Aria2"><a href="#安装Aria2" class="headerlink" title="安装Aria2"></a>安装Aria2</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">opkg install aria2</span><br></pre></td></tr></table></figure><h2 id="配置conf文件"><a href="#配置conf文件" class="headerlink" title="配置conf文件"></a>配置conf文件</h2><p>可以直接用WinSCP直接修改/opt/etc/aria2.conf文件。 也可以直接用我的，需要自己修改下载路径和Token。 (dir=XXX/XXX 和 rpc-secret=XXXX) <a href="https://pan.baidu.com/s/1_xc2lHYIvN53jMRHc2KrHA" title="conf下载" target="_blank" rel="noopener">conf下载</a> 配置完后利用</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/opt/etc/init.d/S81aria2 restart</span><br></pre></td></tr></table></figure><p>重启服务</p><h2 id="更新版本（aria2c文件）"><a href="#更新版本（aria2c文件）" class="headerlink" title="更新版本（aria2c文件）"></a>更新版本（aria2c文件）</h2><p>先将Aria2服务停止</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/opt/etc/init.d/S81aria2 stop</span><br></pre></td></tr></table></figure><p>然后在/opt/bin中替换编译的aria2c文件，并将权限设置为0755后重启Aria2服务。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/opt/etc/init.d/S81aria2 start</span><br></pre></td></tr></table></figure><h2 id="限制CPU占用"><a href="#限制CPU占用" class="headerlink" title="限制CPU占用"></a>限制CPU占用</h2><p>查看了路由器管理界面，发现下载时CPU占用过高，所以要对Aria2进行CPU限制。 安装cpulimit</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">opkg install limitcpu</span><br></pre></td></tr></table></figure><p>安装完后通过命令限制cpu占用</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cpulimit -P aria2c -l 30 -b</span><br></pre></td></tr></table></figure><h2 id="添加开机启动"><a href="#添加开机启动" class="headerlink" title="添加开机启动"></a>添加开机启动</h2><p>在/jffs/scripts/post-mount文件最后添加</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/opt/etc/init.d/S81aria2 start</span><br><span class="line">cpulimit -P aria2c -l 30 -b</span><br></pre></td></tr></table></figure><h2 id="添加自动更新Tracker脚本"><a href="#添加自动更新Tracker脚本" class="headerlink" title="添加自动更新Tracker脚本"></a>添加自动更新Tracker脚本</h2><p>（不建议添加自动更新，会导致Aria2进程莫名消失） 在/opt/var/aria2新建文件trackers-list-aria2.sh写入以下内容，将编码格式设置为UTF-8，并将权限设置为0755。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>!/bin/sh</span><br><span class="line">list=`wget -qO- https://raw.githubusercontent.com/ngosang/trackerslist/master/trackers_all.txt|awk NF|sed ":a;N;s/\n/,/g;ta"`</span><br><span class="line">if [ -z "`grep "bt-tracker" /opt/etc/aria2.conf`" ]; then</span><br><span class="line">    sed -i '$a bt-tracker='$&#123;list&#125; /opt/etc/aria2.conf</span><br><span class="line">    echo add......</span><br><span class="line">else</span><br><span class="line">    sed -i "s@bt-tracker.*@bt-tracker=$list@g" /opt/etc/aria2.conf</span><br><span class="line">    echo update......</span><br><span class="line">fi</span><br><span class="line">sleep 1</span><br><span class="line"></span><br><span class="line">/opt/etc/init.d/S81aria2 restart</span><br></pre></td></tr></table></figure><p>这里可以用</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/bin/sh /opt/var/aria2/trackers-list-aria2.sh</span><br></pre></td></tr></table></figure><p>测试一下这个脚本，如果报错显示</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">syntax error: unexpected end of file (expecting "then")</span><br></pre></td></tr></table></figure><p>那么利用</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /opt/var/aria2/trackers-list-aria2.sh</span><br></pre></td></tr></table></figure><p>删除每行最后所有的^M后保存即可。（具体如何在Linux编辑请百度） 最后将下面定时运行这个脚本命令写入/jffs/scripts/post-mount文件，每天凌晨4点更新Tracker。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cru a trackersupdate "0 4 * * * /bin/sh /opt/var/aria2/trackers-list-aria2.sh"</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;之前折腾了一下小宝固件软件中心的Aria2，安装是方便了，但是问题也不少。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Bug不少，经常莫名其妙假死。&lt;
      
    
    </summary>
    
      <category term="瞎折腾" scheme="http://www.zigma.cc/categories/%E7%9E%8E%E6%8A%98%E8%85%BE/"/>
    
    
      <category term="瞎折腾" scheme="http://www.zigma.cc/tags/%E7%9E%8E%E6%8A%98%E8%85%BE/"/>
    
  </entry>
  
  <entry>
    <title>【瞎折腾】frp+Aria2实现远程下载管理</title>
    <link href="http://www.zigma.cc/2018/05/01/%E3%80%90%E7%9E%8E%E6%8A%98%E8%85%BE%E3%80%91frp+Aria2%E5%AE%9E%E7%8E%B0%E8%BF%9C%E7%A8%8B%E4%B8%8B%E8%BD%BD%E7%AE%A1%E7%90%86/"/>
    <id>http://www.zigma.cc/2018/05/01/【瞎折腾】frp+Aria2实现远程下载管理/</id>
    <published>2018-05-01T03:14:24.000Z</published>
    <updated>2018-06-27T12:55:45.647Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近在捣鼓Aria2下载，恰值西部世界第二季开播，白天上班，无法在内网管理，所以开始折腾内网穿透的事情。 之前用的方案是华硕第三方梅林——小宝固件的DDNS穿透，但是最近一直不稳，而且已经好几天无法连接，所以自己在VPS搭建了frp穿透服务。</p><h2 id="基本思路"><a href="#基本思路" class="headerlink" title="基本思路"></a>基本思路</h2><ol><li>华硕路由搭建Aria2下载环境和frp穿透客户端；</li><li>远程VPS搭建frp穿透服务端；</li><li>顺便搭建AriaNG网页服务端（可选）。<br><img src="http://zigma.qiniudn.com/aria2_frp/4.png" alt="网络拓补" title="网络拓补"></li></ol><h2 id="客户端配置"><a href="#客户端配置" class="headerlink" title="客户端配置"></a>客户端配置</h2><p>华硕路由刷第三方梅林固件，这里使用小宝固件，并在软件中心安装Aria2和frp客户端。</p><h3 id="Ari2设置"><a href="#Ari2设置" class="headerlink" title="Ari2设置"></a>Ari2设置</h3><p><img src="http://zigma.qiniudn.com/aria2_frp/1_1.jpg" alt="Aria2设置" title="Aria2设置1"> <img src="http://zigma.qiniudn.com/aria2_frp/2.jpg" alt="Aria2设置2" title="Aria2设置2"> Aria2常规设置，如果没有速度则添加额外以下Tracker，基本种子都有速度，而且连接速度越来越快了。</p><blockquote><p>udp://9.rarbg.com:2790/announce,udp://9.rarbg.to:2790/announce,udp://inferno.demonoid.pw:3418/announce,udp://bt.aoeex.com:8000/announce,udp://tracker.internetwarriors.net:1337/announce,udp://tracker.swateam.org.uk:2710/announce,udp://tracker.zer0day.to:1337/announce,udp://p4p.arenabg.com:1337/announce,<a href="https://open.kickasstracker.com:443/announce,udp://tracker.coppersurfer.tk:6969,http://torrentsmd.com:8080/announce,udp://tracker.pirateparty.gr:6969/announce,udp://tracker.coppersurfer.tk:6969/announce,udp://tracker4.itzmx.com:2710/announce,udp://tracker.uw0.xyz:6969/announce,udp://tracker.cypherpunks.ru:6969/announce,udp://open.stealth.si:80/announce,http://retracker.telecom.by:80/announce,udp://191.96.249.23:6969/announce,udp://78.142.19.42:1337/announce,udp://123.249.16.65:2710/announce,udp://185.82.217.160:1337/announce,udp://163.172.81.35:1337/announce,https://zer0day.000webhostapp.com:443/announce,udp://public.popcorn-tracker.org:6969/announce,https://linetorrent.xyz:443/announce,udp://tracker.leechers-paradise.org:6969/announce,https://open.acgnxtracker.com:443/announce,http://bt2.54new.com:8080/announce,http://bt1.54new.com:65533/announce,http://ipv6.54new.com:8080/announce,http://tracker.trackerfix.com/announce,udp://tracker.trackerfix.com:80/announce" target="_blank" rel="noopener">https://open.kickasstracker.com:443/announce,udp://tracker.coppersurfer.tk:6969,http://torrentsmd.com:8080/announce,udp://tracker.pirateparty.gr:6969/announce,udp://tracker.coppersurfer.tk:6969/announce,udp://tracker4.itzmx.com:2710/announce,udp://tracker.uw0.xyz:6969/announce,udp://tracker.cypherpunks.ru:6969/announce,udp://open.stealth.si:80/announce,http://retracker.telecom.by:80/announce,udp://191.96.249.23:6969/announce,udp://78.142.19.42:1337/announce,udp://123.249.16.65:2710/announce,udp://185.82.217.160:1337/announce,udp://163.172.81.35:1337/announce,https://zer0day.000webhostapp.com:443/announce,udp://public.popcorn-tracker.org:6969/announce,https://linetorrent.xyz:443/announce,udp://tracker.leechers-paradise.org:6969/announce,https://open.acgnxtracker.com:443/announce,http://bt2.54new.com:8080/announce,http://bt1.54new.com:65533/announce,http://ipv6.54new.com:8080/announce,http://tracker.trackerfix.com/announce,udp://tracker.trackerfix.com:80/announce</a></p></blockquote><p>需要注意的是，BT下载还是勾选LDP和DHT以及勾去强制加密。关于PT下载，以我的理解，不混迹PT论坛、不下载PT资源、只下载热门资源是没有必要去伪装PT客户端的。勾去强制加密是为了提升下载速度。至于端口设置，默认的就行端口转发也没有必要，至少我两层路由下载也一直没有问题。</p><h3 id="frp客户端设置"><a href="#frp客户端设置" class="headerlink" title="frp客户端设置"></a>frp客户端设置</h3><p>按照道理是应该先配置服务端再配置客户端，为了排版好看先放在这里吧。 只列出需要修改的设置，其他均为默认设置。 </p><p>服务器——frp服务端的服务器地址； </p><p>端口——frp服务器监听frp服务的端口，并非访问frp面板的端口； </p><p>Token——搭建服务端时所填写的Token；</p><p>HTTP/HTTPS——如果像我一样在服务端还搭建了网页，就需要更改成其他端口；</p><p>Frpc用户名称——登录frp面板的用户名； </p><p>穿透服务协议——需要在域名解析中新增二级域名，比如test.zigma.cc对应远程主机端口就是上面的HTTP端口8001，192.168.2.1和6800则是本地路由地址和Aria2端口。 <img src="http://zigma.qiniudn.com/aria2_frp/3.jpg" alt="frp设置" title="frp设置"></p><h2 id="服务端配额制"><a href="#服务端配额制" class="headerlink" title="服务端配额制"></a>服务端配额制</h2><p>利用Koolshare社区提供的一键安装包进行安装，安装过程均有提示，这里就不重复造轮子了。 <a href="http://koolshare.cn/thread-65379-1-1.html" title="具体教程链接" target="_blank" rel="noopener">具体教程链接</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget --no-check-certificate https://raw.githubusercontent.com/clangcn/onekey-install-shell/master/frps/install-frps.sh -O ./install-frps.sh</span><br><span class="line">chmod 700 ./install-frps.sh</span><br><span class="line">./install-frps.sh install</span><br></pre></td></tr></table></figure><h2 id="配置AriaNG服务端"><a href="#配置AriaNG服务端" class="headerlink" title="配置AriaNG服务端"></a>配置AriaNG服务端</h2><p>其实这个就是个静态网页，网上的资源还是挺多的，不过自己还有个64M小鸡闲着也是闲着，挂这个UI刚好，配置Nginx后将AriaNG的<a href="https://github.com/mayswind/AriaNg" title="Github项目" target="_blank" rel="noopener">Github项目</a>内容上传到服务器，而且这个项目都是基本请求一次后一直可以在本地缓存中使用，对于Aria2下载状态也是增量请求数据，因此带宽使用很少。 然后在AriaNG设置界面添加RPC地址为解析的二级域名test.zigma.cc，端口对应8001，填写完Token即可，AriaNG自适应移动端，界面友好，在手机端也可以很方便地管理。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;最近在捣鼓Aria2下载，恰值西部世界第二季开播，白天上班，无法在内网管理，所以开始折腾内网穿透的事情。 之前用的方案是华硕第三方梅林——小
      
    
    </summary>
    
      <category term="瞎折腾" scheme="http://www.zigma.cc/categories/%E7%9E%8E%E6%8A%98%E8%85%BE/"/>
    
    
      <category term="瞎折腾" scheme="http://www.zigma.cc/tags/%E7%9E%8E%E6%8A%98%E8%85%BE/"/>
    
  </entry>
  
  <entry>
    <title>【JsBox】利用JSBox在朋友圈斗图（二）</title>
    <link href="http://www.zigma.cc/2018/04/29/%E3%80%90JsBox%E3%80%91%E5%88%A9%E7%94%A8JSBox%E5%9C%A8%E6%9C%8B%E5%8F%8B%E5%9C%88%E6%96%97%E5%9B%BE%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
    <id>http://www.zigma.cc/2018/04/29/【JsBox】利用JSBox在朋友圈斗图（二）/</id>
    <published>2018-04-29T02:20:37.000Z</published>
    <updated>2018-06-27T12:50:53.063Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近继续在研究JSBox，并且发现微信似乎不屏蔽七牛云的链接了，所以将之前图片评论的js移植到了七牛云。七牛云上传是要上传凭证的，怎么计算Token花费不少时间，之前做的方案代码过多，运行效率不高，参考了RYAN大的QiniuManager后成功移植。</p><h2 id="安装链接"><a href="#安装链接" class="headerlink" title="安装链接"></a>安装链接</h2><ul><li><a href="http://7rf2ax.com1.z0.glb.clouddn.com/%E5%9B%BE%E7%89%87%E8%AF%84%E8%AE%BA.js" title="安装链接" target="_blank" rel="noopener">安装链接</a></li></ul><h2 id="详细代码"><a href="#详细代码" class="headerlink" title="详细代码"></a>详细代码</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> CryptoJS = <span class="built_in">require</span>(<span class="string">"crypto-js"</span>)</span><br><span class="line"><span class="built_in">String</span>.prototype.urlsafe = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.replace(<span class="regexp">/\+/g</span>, <span class="string">"-"</span>).replace(<span class="regexp">/\//g</span>, <span class="string">"_"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//计算Token</span></span><br><span class="line"><span class="comment">//你的AK</span></span><br><span class="line"><span class="keyword">var</span> AK = <span class="string">""</span></span><br><span class="line"><span class="comment">//你的SK</span></span><br><span class="line"><span class="keyword">var</span> SK = <span class="string">""</span></span><br><span class="line"><span class="comment">//你的储存空间名</span></span><br><span class="line"><span class="keyword">var</span> bucket = <span class="string">""</span></span><br><span class="line"><span class="comment">//你的储存域名</span></span><br><span class="line"><span class="keyword">var</span> domain = <span class="string">""</span></span><br><span class="line"><span class="keyword">var</span> deadline = <span class="built_in">Math</span>.round(<span class="keyword">new</span> <span class="built_in">Date</span>().getTime() / <span class="number">1000</span>) + <span class="number">1</span> * <span class="number">3600</span></span><br><span class="line"><span class="keyword">var</span> params = &#123;<span class="attr">scope</span>: bucket,<span class="attr">deadline</span>: deadline&#125;</span><br><span class="line"><span class="keyword">var</span> policy = <span class="built_in">JSON</span>.stringify(params)</span><br><span class="line"><span class="keyword">var</span> policyEncoded = $text.base64Encode(policy).urlsafe()</span><br><span class="line"><span class="keyword">var</span> sign = CryptoJS.HmacSHA1(policyEncoded, SK)</span><br><span class="line"><span class="keyword">var</span> signEncoded = sign.toString(CryptoJS.enc.Base64).urlsafe()</span><br><span class="line"><span class="keyword">var</span> token = AK + <span class="string">":"</span> + signEncoded + <span class="string">":"</span> + policyEncoded</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">PickImage</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  $photo.pick(&#123;</span><br><span class="line">    format: <span class="string">"image"</span>,</span><br><span class="line">    handler: <span class="function"><span class="keyword">function</span>(<span class="params">resp</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> image = resp.image</span><br><span class="line">      <span class="keyword">if</span> (image) &#123;</span><br><span class="line">        Upload(image)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $ui.loading(<span class="literal">false</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Upload</span>(<span class="params">image</span>) </span>&#123;</span><br><span class="line">  $http.upload(&#123;</span><br><span class="line">    url: <span class="string">"http://upload.qiniu.com/"</span>,</span><br><span class="line">    form: &#123;</span><br><span class="line">      token: token</span><br><span class="line">    &#125;,</span><br><span class="line">    files: [&#123;</span><br><span class="line">      <span class="string">"image"</span>: image,</span><br><span class="line">      <span class="string">"name"</span>: <span class="string">"file"</span>,</span><br><span class="line">      <span class="string">"filename"</span>: <span class="string">"file"</span></span><br><span class="line">    &#125;],</span><br><span class="line">    progress: <span class="function"><span class="keyword">function</span>(<span class="params">percentage</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line">    handler: <span class="function"><span class="keyword">function</span>(<span class="params">resp</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> url = domain + resp.data.key</span><br><span class="line">      <span class="keyword">if</span> (url) &#123;</span><br><span class="line">        Shorturl(url)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $ui.alert(<span class="string">"图片上传失败"</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Shorturl</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">  $http.shorten(&#123;</span><br><span class="line">    url: url,</span><br><span class="line">    handler: <span class="function"><span class="keyword">function</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (url) &#123;</span><br><span class="line">        $clipboard.text = <span class="string">"图片评论 "</span> + url</span><br><span class="line">        $ui.toast(<span class="string">"复制成功"</span>, <span class="number">2</span>)</span><br><span class="line">        $app.close(<span class="number">2</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> inputImage = $context.image</span><br><span class="line"><span class="keyword">if</span> (inputImage) &#123;</span><br><span class="line">  Upload(inputImage)</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  PickImage()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;最近继续在研究JSBox，并且发现微信似乎不屏蔽七牛云的链接了，所以将之前图片评论的js移植到了七牛云。七牛云上传是要上传凭证的，怎么计算T
      
    
    </summary>
    
      <category term="JsBox" scheme="http://www.zigma.cc/categories/JsBox/"/>
    
    
      <category term="JsBox" scheme="http://www.zigma.cc/tags/JsBox/"/>
    
  </entry>
  
  <entry>
    <title>利用Documents管理云盘文件</title>
    <link href="http://www.zigma.cc/2018/02/02/%E5%88%A9%E7%94%A8Documents%E7%AE%A1%E7%90%86%E4%BA%91%E7%9B%98%E6%96%87%E4%BB%B6/"/>
    <id>http://www.zigma.cc/2018/02/02/利用Documents管理云盘文件/</id>
    <published>2018-02-02T11:48:28.000Z</published>
    <updated>2018-06-26T13:48:11.622Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>自从总公司规定内网电脑不能使用U盘以后，内外网数据互通就麻烦了不少，虽然给每人发放了一个光盘刻录机，但是工作质量总感觉退回了上世纪。 好在省公司开发了一个内外网数据互通的云盘，与其说是开发，不如说是剔除了一些功能的ownCloud个人云存储开源解决方案。 虽然脱离了上世纪的办公环境，但是工作效率还是停留在本世纪初，数据流通依旧十分不方便。有笔记本的同志自然不必说，直接网页操作就可以了，如果是手机用户，则必须要iOS11以上系统支持或者使用iCabMobile等工具才可以使用，但是操作流程十分繁复：比如要将微信内Word转移到内网需要以下步骤，微信内打开Word→跳转保存到“文件”或者iCabMobile等App→浏览器打开网盘地址并登陆→点击上传按钮选择文件上传。 可喜的是，今天例行帮小伙伴转移文件后，查看了一下网盘的源代码，发现了这么一段代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;app-settings-content&quot;&gt; </span><br><span class="line">        &lt;label for=&quot;webdavurl&quot;&gt;WebDAV&lt;/label&gt;</span><br><span class="line">        &lt;input id=&quot;webdavurl&quot; type=&quot;text&quot; readonly=&quot;readonly&quot; value=&quot;http://60.191.98.250/remote.php/webdav/&quot; /&gt;</span><br><span class="line">        &lt;em&gt;使用这个地址 &lt;a href=&quot;https://doc.owncloud.org/server/9.0/go.php?to=user-webdav&quot; target=&quot;_blank&quot;&gt;通过 WebDAV 访问您的文件&lt;/a&gt;&lt;/em&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>就是说云盘是支持webDAV协议的，利用手机App即可进行文件管理，虽然在云盘操作界面没有显示这段话。这样的话，分享文件就变得十分简单了，只需要在微信中将文件打开，点击分享按钮，找到拷贝到具体App中即可跳转直接保存到网盘，同理从内网转移到外网只需要将流程翻转即可。</p><h2 id="横向评测支持webDAV的App"><a href="#横向评测支持webDAV的App" class="headerlink" title="横向评测支持webDAV的App"></a>横向评测支持webDAV的App</h2><p>方向有了，就很好办了，在App Store中搜索关键词webDAV就可以找到不少App，但是大部分需要收费，因此以下评测了3款免费软件：FileExploer、WPS Office、Documents。</p><h3 id="FileExploer"><a href="#FileExploer" class="headerlink" title="FileExploer"></a>FileExploer</h3><p>如图进行设置，HOST Url填写<a href="http://60.191.98.250/remote.php/webdav/" target="_blank" rel="noopener">http://60.191.98.250/remote.php/webdav/</a> 用户名及密码与内网一致。 <img src="http://7rf2ax.com1.z0.glb.clouddn.com/Document/1.jpg" alt="FileExploer设置" title="FileExploer设置"> <img src="http://7rf2ax.com1.z0.glb.clouddn.com/Document/2.jpg" alt="FileExploer设置" title="FileExploer设置"> 这款App是第一个下的，如果没有发现Documents这款App的话，日常使用也足够了，并且支持图片、文件等多类型文件上传与下载。 值得一提的是，微信中点击分享→点击拷贝到“FileExploer”后直接会让你选择保存位置，你只需要选择云盘即可直接保存入盘，十分方便。 唯一美中不足的是，因为是免费软件，所以时常会跳出升级到专业版的提示，如果能够接受30元的价格，升级支持一下国产软件也是可以的。 推荐指数：★★★☆☆</p><h3 id="WPS-Office"><a href="#WPS-Office" class="headerlink" title="WPS Office"></a>WPS Office</h3><p>是的，你没有看错，WPS手机版也是支持webDAV协议的，如图进行设置，输入内容与前一款一致。 <img src="http://7rf2ax.com1.z0.glb.clouddn.com/Document/3.jpg" alt="WPS Office设置" title="WPS Office设置"> <img src="http://7rf2ax.com1.z0.glb.clouddn.com/Document/41.jpg" alt="WPS Office设置" title="WPS Office设置"> WPS的优点在于可以对文档直接进行编辑然后分享，大厂出品自然不会夹带广告，但是也有模板之类的收费内容。 WPS的缺点也十分明显，它并不支持图片等格式上传，只支持Word、Excel、PowerPoint三款办公软件文档上传。而且上传方式十分麻烦，需要先保存到WPS中，再在网盘页面右上角按钮处点击进行文档上传。 推荐需要直接编辑，对文件支持类型要求不大的用户使用。 推荐指数：★★☆☆☆</p><h3 id="Documents"><a href="#Documents" class="headerlink" title="Documents"></a>Documents</h3><p>Documents全称是Documents 6或者Documents By Readdle，可能是因为叫Documents的太多了吧。 需要注意的是，软件默认是屏蔽第三方输入法的，如果有需要第三方输入法，则需要在主界面的设置→通用关闭对第三方输入法的屏蔽。 <img src="http://7rf2ax.com1.z0.glb.clouddn.com/Document/5.jpg" alt="Documents设置" title="Documents设置"> 其他设置与其他软件一致。 <img src="http://7rf2ax.com1.z0.glb.clouddn.com/Document/61.jpg" alt="Documents设置" title="Documents设置"> 此外Documents还支持双向同步，十分方便。 <img src="http://7rf2ax.com1.z0.glb.clouddn.com/Document/7.jpg" alt="Documents设置" title="Documents设置"> <img src="http://7rf2ax.com1.z0.glb.clouddn.com/Document/8.jpg" alt="Documents设置" title="Documents设置"> 上传的风格与WPS类似。 Documents可以说是三款App中功能最为强大的，不仅支持多文件格式，还支持文件夹同步。 电脑端上传以后，马上可以在手机中查看、分享，并且支持URL Scheme，可以直接将文档Url在App中打开，并且没有广告。 唯一的短板就是不支持拷贝到App后直接选择文件，但是瑕不掩瑜，这款App值得作为主力工具使用。 推荐指数：★★★★☆</p><h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><p>至此，三款App已经评测完毕，如果还是有不明白的，可以留言，视情况录制视频。 此外，文件管理器大多雷同，因此这里也不再评测其他软件。 至于安卓用户，系统比iOS开放许多，只需要安装类似支持webDAV协议的文件管理器即可，使用习惯也是大同小异。 说句题外话，今天小伙伴没法下载损坏的Word文档所以还研究了一下利用Wireshark直接抓包档案系统的扫描图片，并利用ABBYY的ORC转换为Word，下次有空再写教程。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;自从总公司规定内网电脑不能使用U盘以后，内外网数据互通就麻烦了不少，虽然给每人发放了一个光盘刻录机，但是工作质量总感觉退回了上世纪。 好在省
      
    
    </summary>
    
      <category term="工作" scheme="http://www.zigma.cc/categories/%E5%B7%A5%E4%BD%9C/"/>
    
    
  </entry>
  
  <entry>
    <title>【JsBox】利用JSBox在朋友圈斗图（一）</title>
    <link href="http://www.zigma.cc/2018/02/01/%E3%80%90JsBox%E3%80%91%E5%88%A9%E7%94%A8JSBox%E5%9C%A8%E6%9C%8B%E5%8F%8B%E5%9C%88%E6%96%97%E5%9B%BE%EF%BC%88%E4%B8%80%EF%BC%89/"/>
    <id>http://www.zigma.cc/2018/02/01/【JsBox】利用JSBox在朋友圈斗图（一）/</id>
    <published>2018-02-01T12:04:49.000Z</published>
    <updated>2018-06-27T12:49:55.648Z</updated>
    
    <content type="html"><![CDATA[<p>刷惯了微博，总是想在微信朋友圈里面用因缺思厅的（贱贱的）表情包评论，亦或者在发完朋友圈之后再在评论里面Po出后续。 想了一下，思路不难，只需要将图片通过API接口上传到图床后再通过短链形式发出去即可。 先用了Workflow试水一波，但是自从Workflow被苹果收购以后不得不吐槽一下下降的厉害的软件质量。Get Contents of URL里面填写多个Body值，不是这个无法显示就是那个无法编辑，再加上流程过长修改十分不便，差不多要放弃这个工具App了。 好在之前低价购买了JSBox，虽然还有些功能不是很完善，例如类似Workflow里面的Overlay Image的功能暂时缺失，但是胜在界面清爽和相对完善的官方文档。 关于图床选择有很多，谷歌百度搜索一大把，短链转换也有很多，相对于Workflow，JSBox另一个优势在于内置很多功能，比如长短链的转换，省去了申请API的时间。</p><h2 id="关于图床"><a href="#关于图床" class="headerlink" title="关于图床"></a>关于图床</h2><p>在微信里面使用图床，最为关键的要看马爸爸有没有屏蔽，在试过几个主流图床后，使用效果如下。</p><ul><li><p>贴图库，勉强能用，如果用Workflow无损上传PNG的话40%会被屏蔽，利用JSBox压缩成jpg基本不会； </p></li><li><p>sm.ms，全站被屏蔽； </p></li><li><p>七牛云，会提示跳转，需多余操作，体验效果不佳； </p></li><li><p>微博，新浪已更改API接口，无法使用。 </p></li></ul><p>因此在图床上面还是选择贴图库比较妥当，需要注意的是普通用户上传图片7日后会删除，并且频率也会有一定限制。</p><h2 id="关于短链转换"><a href="#关于短链转换" class="headerlink" title="关于短链转换"></a>关于短链转换</h2><p>虽然JSBox有现成的短链转换函数，但是在Workflow上面还是折腾比较久。因为懒得申请微博API，所以先是在百度找了一个不知名的小站做转换，实际效果是在微信中跳转时要求关注公众号，所以枪毙了。之后在Workflow里面找到一个转短链的流程，里面留了个公用Token，试了试也可以用，而且微信不屏蔽也不需要关注公众号。但是这样用人家的Token始终有些膈应，因此把Workflow流程搬到了JSBox中。</p><h2 id="JSBox代码"><a href="#JSBox代码" class="headerlink" title="JSBox代码"></a>JSBox代码</h2><p>第一次接触JavaScript，好在有官方文档可以查看。脚本流程原理也很简单，选取相册图片或者直接在相册选取图片以后利用Upload函数上传到图床，并将返回链接转换为短链，并拷贝到粘贴板。 代码如下：添加ID和Token即可食用，配合JSBox里的斗图啦脚本风味更加。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">PickImage</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  $photo.pick(&#123;</span><br><span class="line">    format: <span class="string">"image"</span>,</span><br><span class="line">    handler: <span class="function"><span class="keyword">function</span>(<span class="params">resp</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> image = resp.image</span><br><span class="line">      <span class="keyword">if</span> (image) &#123;</span><br><span class="line">        Upload(image.jpg(<span class="number">1</span>, <span class="number">0</span>))</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $ui.loading(<span class="literal">false</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Upload</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  $ui.loading(<span class="literal">true</span>)</span><br><span class="line">  $http.upload(&#123;</span><br><span class="line">    url: <span class="string">"http://up.imgapi.com/"</span>,</span><br><span class="line">    form: &#123;</span><br><span class="line">      <span class="keyword">from</span>: <span class="string">"file"</span>,</span><br><span class="line">      aid: <span class="string">"你的相册ID"</span>,</span><br><span class="line">      Token: <span class="string">"你的Token"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    files: [&#123;</span><br><span class="line">      <span class="string">"data"</span>: data,</span><br><span class="line">      <span class="string">"name"</span>: <span class="string">"file"</span></span><br><span class="line">    &#125;],</span><br><span class="line">    handler: <span class="function"><span class="keyword">function</span>(<span class="params">resp</span>) </span>&#123;</span><br><span class="line">      $ui.loading(<span class="literal">false</span>)</span><br><span class="line">      <span class="keyword">var</span> url = resp.data.linkurl</span><br><span class="line">      <span class="keyword">if</span> (url) &#123;</span><br><span class="line">        Shorturl(url)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $ui.alert(<span class="string">"图片上传失败"</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Shorturl</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">  $http.shorten(&#123;</span><br><span class="line">    url: url,</span><br><span class="line">    handler: <span class="function"><span class="keyword">function</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (url) &#123;</span><br><span class="line">        $clipboard.text = <span class="string">"图片评论 "</span> + url</span><br><span class="line">        $ui.toast(<span class="string">"复制成功"</span>, <span class="number">2</span>)</span><br><span class="line">        $app.close(<span class="number">2</span>)</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> inputData = $context.data</span><br><span class="line"><span class="keyword">var</span> inputLink = $context.link</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (inputData) &#123;</span><br><span class="line">  Upload(inputData)</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (inputLink) &#123;</span><br><span class="line">  Shorturl(inputLink)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  PickImage()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="朋友圈效果"><a href="#朋友圈效果" class="headerlink" title="朋友圈效果"></a>朋友圈效果</h2><p><img src="http://7rf2ax.com1.z0.glb.clouddn.com/JSBox/JSBox1.jpg" alt="JSBox" title="JSBox"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;刷惯了微博，总是想在微信朋友圈里面用因缺思厅的（贱贱的）表情包评论，亦或者在发完朋友圈之后再在评论里面Po出后续。 想了一下，思路不难，只需要将图片通过API接口上传到图床后再通过短链形式发出去即可。 先用了Workflow试水一波，但是自从Workflow被苹果收购以后不
      
    
    </summary>
    
      <category term="JsBox" scheme="http://www.zigma.cc/categories/JsBox/"/>
    
    
      <category term="JsBox" scheme="http://www.zigma.cc/tags/JsBox/"/>
    
  </entry>
  
  <entry>
    <title>一键移除Win10此电脑中多余文件夹</title>
    <link href="http://www.zigma.cc/2017/12/09/%E4%B8%80%E9%94%AE%E7%A7%BB%E9%99%A4Win10%E6%AD%A4%E7%94%B5%E8%84%91%E4%B8%AD%E5%A4%9A%E4%BD%99%E6%96%87%E4%BB%B6%E5%A4%B9/"/>
    <id>http://www.zigma.cc/2017/12/09/一键移除Win10此电脑中多余文件夹/</id>
    <published>2017-12-08T16:51:56.000Z</published>
    <updated>2018-06-26T13:53:19.617Z</updated>
    
    <content type="html"><![CDATA[<p>Win10常年更新一些没什么卵用的功能，最近又有一次大更新。可气的是每次更新都会把一些设置重置。比如移除快捷方式的小箭头、已经移除的此电脑里面的各种文件夹。最近的更新还更新了一个3D图像文件夹，普通人肯定用不到，而且用惯了Win7的用户肯定也不习惯原本清爽的计算机里面出现这么多五花八门的文件夹，比如说我，在侧边栏出现那么多繁乱的文件夹都受不了，更何况在主界面。</p><h2 id="利用注册表来移除文件夹"><a href="#利用注册表来移除文件夹" class="headerlink" title="利用注册表来移除文件夹"></a>利用注册表来移除文件夹</h2><p>所幸能够通过修改注册表来移除这些文件夹，简单便捷无污染，唯一缺点就是每次更新后需要重新运行一次。 每次在注册表查找键值太麻烦，所以弄成了注册表注册文件。 新建记事本后复制粘贴以下代码，保存后将txt后缀改为reg，完成后双击运行即可。</p><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Windows Registry Editor Version <span class="number">5.00</span></span><br><span class="line">[-HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\&#123;f86fa3ab<span class="number">-70</span>d2<span class="number">-4</span>fc7<span class="number">-9</span>c99-fcbf05467f3a&#125;]</span><br><span class="line">[-HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\&#123;d3162b92<span class="number">-9365</span><span class="number">-467</span>a<span class="number">-956</span>b<span class="number">-92703</span>aca08af&#125;]</span><br><span class="line">[-HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\&#123;B4BFCC3A-DB2C<span class="number">-424</span>C-B029<span class="number">-7</span>FE99A87C641&#125;]</span><br><span class="line">[-HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\&#123;<span class="number">3</span>dfdf296-dbec<span class="number">-4</span>fb4<span class="number">-81</span>d1<span class="number">-6</span>a3438bcf4de&#125;]</span><br><span class="line">[-HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\&#123;<span class="number">088e3905</span><span class="number">-0323</span><span class="number">-4</span>b02<span class="number">-9826</span><span class="number">-5</span>d99428e115f&#125;]</span><br><span class="line">[-HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\&#123;<span class="number">24</span>ad3ad4-a569<span class="number">-4530</span><span class="number">-98e1</span>-ab02f9417aa8&#125;]</span><br><span class="line">[-HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\&#123;<span class="number">0</span>DB7E03F-FC29<span class="number">-4</span>DC6<span class="number">-9020</span>-FF41B59E513A&#125;]</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Win10常年更新一些没什么卵用的功能，最近又有一次大更新。可气的是每次更新都会把一些设置重置。比如移除快捷方式的小箭头、已经移除的此电脑里面的各种文件夹。最近的更新还更新了一个3D图像文件夹，普通人肯定用不到，而且用惯了Win7的用户肯定也不习惯原本清爽的计算机里面出现这
      
    
    </summary>
    
      <category term="VPS" scheme="http://www.zigma.cc/categories/VPS/"/>
    
    
      <category term="WIN10" scheme="http://www.zigma.cc/tags/WIN10/"/>
    
  </entry>
  
  <entry>
    <title>【VBA】利用VBA提取词库重复值</title>
    <link href="http://www.zigma.cc/2017/11/09/%E3%80%90VBA%E3%80%91%E5%88%A9%E7%94%A8VBA%E6%8F%90%E5%8F%96%E8%AF%8D%E5%BA%93%E9%87%8D%E5%A4%8D%E5%80%BC/"/>
    <id>http://www.zigma.cc/2017/11/09/【VBA】利用VBA提取词库重复值/</id>
    <published>2017-11-09T14:27:05.000Z</published>
    <updated>2018-06-26T14:00:02.568Z</updated>
    
    <content type="html"><![CDATA[<p>之前提取过一个小鹤的辅码表，但是在使用过程中很容易和词库的常用词撞车，为了输入效率只能在自定义编码中固定常用词的候选次序，所以想从主码表内提取容易和常用词重复的辅码，并且固定辅码位置，虽然最后发现了辅码表内并不能设置辅码的位置，只能将自定义编码内的词往前移，顶掉辅码。 主码表内有56000多条记录，手动操作标记肯定是不可能的，边用边在App中自定义编码标记虽然可行，但是效率太低，而且有时候多打几个字就会忘了哪个词需要标记，所以还是用手头的Excel来提取数据。</p><h2 id="Excel自带的标记重复值"><a href="#Excel自带的标记重复值" class="headerlink" title="Excel自带的标记重复值"></a>Excel自带的标记重复值</h2><p>虽然EXCEL有标记重复值的功能，但是也仅仅是标记，并不会写到数据里面。 比如说自定义标记重复值的背景为红色，但是利用Get.Cell公式读取还是原来的背景色。所以想要利用标记重复值，再进行VBA通过背景色删除是无法实现的。</p><h2 id="VBA提取"><a href="#VBA提取" class="headerlink" title="VBA提取"></a>VBA提取</h2><p>绕了太远果然容易扯着蛋，转念一想利用一个简简单单的For循环和If条件判断就实现了。 逐个匹配判断与下一个的值，重复则输出本行与下一行，再利用代码删除未输出的行，即判断输出列的单元格是否是空白，是则删除整行即可。</p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> Test()</span><br><span class="line">    <span class="keyword">With</span> Sheet1</span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">1</span> <span class="keyword">to</span> <span class="number">45000</span></span><br><span class="line">        <span class="keyword">If</span> .Range(<span class="string">"A"</span>&amp;i) = .Range(<span class="string">"A"</span>&amp;i+<span class="number">1</span>) <span class="keyword">Then</span></span><br><span class="line">            .Range(<span class="string">"B"</span>&amp;i)=.Range(<span class="string">"A"</span>&amp;i)</span><br><span class="line">            .Range(<span class="string">"B"</span>&amp;i+<span class="number">1</span>)=.Range(<span class="string">"A"</span>&amp;i+<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line">    .Range(<span class="string">"B:B"</span>).SpecialCells(xlCellTypeBlanks).EntireRow.Delete</span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;之前提取过一个小鹤的辅码表，但是在使用过程中很容易和词库的常用词撞车，为了输入效率只能在自定义编码中固定常用词的候选次序，所以想从主码表内提取容易和常用词重复的辅码，并且固定辅码位置，虽然最后发现了辅码表内并不能设置辅码的位置，只能将自定义编码内的词往前移，顶掉辅码。 主码
      
    
    </summary>
    
      <category term="VBA" scheme="http://www.zigma.cc/categories/VBA/"/>
    
    
      <category term="VBA" scheme="http://www.zigma.cc/tags/VBA/"/>
    
  </entry>
  
  <entry>
    <title>自制Potplayer皮肤两例</title>
    <link href="http://www.zigma.cc/2017/11/07/%E8%87%AA%E5%88%B6Potplayer%E7%9A%AE%E8%82%A4%E4%B8%A4%E4%BE%8B/"/>
    <id>http://www.zigma.cc/2017/11/07/自制Potplayer皮肤两例/</id>
    <published>2017-11-07T11:15:45.000Z</published>
    <updated>2018-06-26T13:53:44.028Z</updated>
    
    <content type="html"><![CDATA[<p>以前留存的两例Potplayer皮肤，仅仅是简单的外观，不支持复杂功能（因为会有BUG，又懒得改）。</p><h2 id="1-Ti"><a href="#1-Ti" class="headerlink" title="1.Ti"></a>1.Ti</h2><p><img src="http://7rf2ax.com1.z0.glb.clouddn.com/potplayer/Ti.jpg" alt="Ti" title="Ti"></p><h2 id="2-BotPlayer"><a href="#2-BotPlayer" class="headerlink" title="2.BotPlayer"></a>2.BotPlayer</h2><p>素材提取自iOS应用TweetBot。 <img src="http://7rf2ax.com1.z0.glb.clouddn.com/potplayer/BotPlayer1.jpg" alt="BotPlayer1" title="BotPlayer1"> <img src="http://7rf2ax.com1.z0.glb.clouddn.com/potplayer/BotPlayer2.jpg" alt="BotPlayer2" title="BotPlayer2"></p><h2 id="3-下载"><a href="#3-下载" class="headerlink" title="3.下载"></a>3.下载</h2><p><a href="https://pan.baidu.com/s/1dDoxoa9" title="Ti" target="_blank" rel="noopener">Ti</a></p><p><a href="https://pan.baidu.com/s/1eQcPZ4Q" title="Botplayer" target="_blank" rel="noopener">Botplayer</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;以前留存的两例Potplayer皮肤，仅仅是简单的外观，不支持复杂功能（因为会有BUG，又懒得改）。&lt;/p&gt;
&lt;h2 id=&quot;1-Ti&quot;&gt;&lt;a href=&quot;#1-Ti&quot; class=&quot;headerlink&quot; title=&quot;1.Ti&quot;&gt;&lt;/a&gt;1.Ti&lt;/h2&gt;&lt;p&gt;&lt;img
      
    
    </summary>
    
      <category term="Potplayer皮肤" scheme="http://www.zigma.cc/categories/Potplayer%E7%9A%AE%E8%82%A4/"/>
    
    
      <category term="PotPlayer" scheme="http://www.zigma.cc/tags/PotPlayer/"/>
    
  </entry>
  
  <entry>
    <title>落格输入法配置相关</title>
    <link href="http://www.zigma.cc/2017/10/28/%E8%90%BD%E6%A0%BC%E8%BE%93%E5%85%A5%E6%B3%95%E9%85%8D%E7%BD%AE%E7%9B%B8%E5%85%B3/"/>
    <id>http://www.zigma.cc/2017/10/28/落格输入法配置相关/</id>
    <published>2017-10-28T09:11:26.000Z</published>
    <updated>2018-06-26T13:53:38.210Z</updated>
    
    <content type="html"><![CDATA[<p>之前在少数派看了篇介绍双拼输入法的文章，觉得其中一句“学习双拼之前，会觉得卧槽竟然有傻逼用双拼；刚接触，会觉得卧槽还可以；熟悉以后，会觉得卧槽怎么会有傻逼用全拼”（差不多就这么个意思）高度概括了学习双拼前后的变化。</p><p> 说实话，学习双拼并没有想象中的那么难，在微信小程序里面有一个“双拼练习”的小程序可以帮助你快速熟悉音形码，PC上这类联系工具则更多了。基本一晚上就可以把音形码记得差不多，一周之后就可以熟练使用，而且没有全拼打字的肌肉酸胀感，之前开一天庭，最后手部肌肉会酸痛。 </p><p>虽然iOS11原生输入法支持了双拼，但是并不能更换双拼方案，而搜狗的空格键、中/英键和发送键挨的太近，导致空格键变短，很容易输入长句后，想要空格上屏却误触中/英切换，又要重新输入一遍。而且也无法像百度输入法一样可以自定义皮肤，这里还要再吐槽一下搜狗，之前做过一个仿锤子手机的键盘皮肤，做完发现上传审核后无法在iOS使用，只能在安卓安装，虽然iOS可以上架但是对于iOS皮肤的审核也是极其麻烦。 为什么不用百度？就是单纯地不想再用他家的任何产品~ 最后我选择了最为接近原生输入法的落格输入法。 </p><p>在Price Tag里面有一期送了落格输入法的兑换码，说实话个人对这个App主打的拒绝读取权限以保护隐私的宣传点并不是很感冒，因为App的易用性和用户隐私保护有时候在实现目的上还是挺对立的，需要预测输入习惯势必要依赖大数据，但是大数据又包含了你的点点滴滴。 但是，并没有十全十美的App，某些不知名的原因落格终止了和小鹤的合作，不再支持也不允许用户自定义上传小鹤的双拼方案（但是改个名字自定义还是可以的），所以在落格上面使用小鹤的双拼方案也是比较麻烦。 </p><p>因此写了这篇文章记录一下落格上面使用小鹤的方案。</p><h2 id="1、点划配置以及皮肤"><a href="#1、点划配置以及皮肤" class="headerlink" title="1、点划配置以及皮肤"></a>1、点划配置以及皮肤</h2><p><img src="http://7rf2ax.com1.z0.glb.clouddn.com/Log/Log.jpg" alt=""> 如图，上下划都可以进行操作，基本上向上是中文半角符号，向下是英文半角。 还有自带的宏，就用了中英切换、到行首、到行尾三个，所支持所有的宏<a href="https://v2mm.tech/topic/618/%E6%80%8E%E6%A0%B7%E4%BC%98%E9%9B%85%E5%9C%B0%E4%BD%BF%E7%94%A8%E8%90%BD%E6%A0%BC%E8%BE%93%E5%85%A5%E6%B3%95%E7%9A%84%E7%82%B9%E5%88%92%E5%8A%9F%E8%83%BD" title="点击" target="_blank" rel="noopener">点击</a>。</p><h2 id="2、双拼方案"><a href="#2、双拼方案" class="headerlink" title="2、双拼方案"></a>2、双拼方案</h2><p>改了个名字而已，小鸡双拼，不然在App里面看不到。</p><h2 id="3、词库导入"><a href="#3、词库导入" class="headerlink" title="3、词库导入"></a>3、词库导入</h2><p>论坛有大佬分享词库转换导入的<a href="https://v2mm.tech/topic/1157/%E5%B0%8F%E5%B7%A5%E5%85%B7-%E6%B7%BB%E5%8A%A0%E6%90%9C%E7%8B%97%E7%BB%86%E8%83%9E%E8%AF%8D%E5%BA%93%E5%88%B0%E8%90%BD%E6%A0%BC" title="教程" target="_blank" rel="noopener">教程</a>和工具，但是没有提供小鹤的转换方案，所以一并备份了。</p><h2 id="4、小鸡辅码"><a href="#4、小鸡辅码" class="headerlink" title="4、小鸡辅码"></a>4、小鸡辅码</h2><p>从小鹤外挂词库中提取了单词辅码。</p><h2 id="5、下载地址"><a href="#5、下载地址" class="headerlink" title="5、下载地址"></a>5、下载地址</h2><p><a href="https://pan.baidu.com/s/1g0WJfIP3BfFvdSmzFwQbhg" title="百度网盘" target="_blank" rel="noopener">百度网盘</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;之前在少数派看了篇介绍双拼输入法的文章，觉得其中一句“学习双拼之前，会觉得卧槽竟然有傻逼用双拼；刚接触，会觉得卧槽还可以；熟悉以后，会觉得卧槽怎么会有傻逼用全拼”（差不多就这么个意思）高度概括了学习双拼前后的变化。&lt;/p&gt;
&lt;p&gt; 说实话，学习双拼并没有想象中的那么难，在微
      
    
    </summary>
    
      <category term="App" scheme="http://www.zigma.cc/categories/App/"/>
    
    
      <category term="落格" scheme="http://www.zigma.cc/tags/%E8%90%BD%E6%A0%BC/"/>
    
  </entry>
  
  <entry>
    <title>【VBA】利用VBA提取内容并生成新文件</title>
    <link href="http://www.zigma.cc/2017/09/27/%E3%80%90VBA%E3%80%91%E5%88%A9%E7%94%A8VBA%E6%8F%90%E5%8F%96%E5%86%85%E5%AE%B9%E5%B9%B6%E7%94%9F%E6%88%90%E6%96%B0%E6%96%87%E4%BB%B6/"/>
    <id>http://www.zigma.cc/2017/09/27/【VBA】利用VBA提取内容并生成新文件/</id>
    <published>2017-09-27T15:04:13.000Z</published>
    <updated>2018-06-26T13:59:50.269Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>工作中一直需要根据一个Word文件内的内容提取后放到其他Word模板中整合为一个新的文件，数量一多就很烦，所以利用VBA写了一个工具，利用正则表达式来提取指定文件的内容并根据既定的模板生成新文件。</p><h2 id="Excel各项目布局"><a href="#Excel各项目布局" class="headerlink" title="Excel各项目布局"></a>Excel各项目布局</h2><p><a href="http://7rf2ax.com1.z0.glb.clouddn.com/%E6%8F%90%E5%8F%96%E7%94%9F%E6%88%90.png" title="Excel布局" target="_blank" rel="noopener"><img src="http://7rf2ax.com1.z0.glb.clouddn.com/%E6%8F%90%E5%8F%96%E7%94%9F%E6%88%90.png" alt="Excel布局" title="Excel布局"></a> B列为正则表达式，根据不同的提取部位进行编辑。 C列为模板文档位置。 D列为需要提取文件的目录。 E、F、G、H、I列为提取的内容。</p><h2 id="代码如下："><a href="#代码如下：" class="headerlink" title="代码如下："></a>代码如下：</h2><h3 id="获取需要提取的文件路径"><a href="#获取需要提取的文件路径" class="headerlink" title="获取需要提取的文件路径"></a>获取需要提取的文件路径</h3><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> getfile()</span><br><span class="line">    <span class="keyword">Dim</span> Myname, Dic, Did, i, t, F, MyFileName</span><br><span class="line">    <span class="keyword">Set</span> objshell = CreateObject(<span class="string">"Shell.Application"</span>)</span><br><span class="line">    <span class="keyword">Set</span> objFolder = objshell.browseForFolder(<span class="number">0</span>, <span class="string">"选择文件夹"</span>, <span class="number">0</span>, <span class="number">0</span>) <span class="comment">'选择需要遍历的文件夹'</span></span><br><span class="line">    <span class="keyword">If</span> <span class="keyword">Not</span> objFolder <span class="keyword">Is</span> <span class="literal">Nothing</span> <span class="keyword">Then</span> lj = objFolder.self.Path &amp; <span class="string">"\" Else Exit Sub '如果选择了文件夹则输出文件夹的路径'</span></span><br><span class="line"><span class="string">    Set objFolder = Nothing</span></span><br><span class="line"><span class="string">    Set objshell = Nothing</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Set Dic = CreateObject("</span>Scripting.Dictionary<span class="string">") '设置字典'</span></span><br><span class="line"><span class="string">    Set Did = CreateObject("</span>Scripting.Dictionary<span class="string">")</span></span><br><span class="line"><span class="string">    Dic.Add (lj), "</span><span class="string">" '将路径添加到Dic字典'</span></span><br><span class="line"><span class="string">    i = 0</span></span><br><span class="line"><span class="string">    Do While i &lt; Dic.Count</span></span><br><span class="line"><span class="string">        ke = Dic.keys</span></span><br><span class="line"><span class="string">        Myname = Dir(ke(i), vbDirectory)</span></span><br><span class="line"><span class="string">        Do While Myname &lt;&gt; "</span><span class="string">"</span></span><br><span class="line"><span class="string">            If Myname &lt;&gt; "</span>.<span class="string">" And Myname &lt;&gt; "</span>..<span class="string">" Then</span></span><br><span class="line"><span class="string">                If (GetAttr(ke(i) &amp; Myname) And vbDirectory) = vbDirectory Then</span></span><br><span class="line"><span class="string">                Dic.Add (ke(i) &amp; Myname &amp; "</span>\<span class="string">"), "</span><span class="string">"</span></span><br><span class="line"><span class="string">                End If</span></span><br><span class="line"><span class="string">            End If</span></span><br><span class="line"><span class="string">            Myname = Dir</span></span><br><span class="line"><span class="string">        Loop</span></span><br><span class="line"><span class="string">        i = i + 1</span></span><br><span class="line"><span class="string">    Loop</span></span><br><span class="line"><span class="string">    For Each m In Dic.keys</span></span><br><span class="line"><span class="string">        Did.Add (m), "</span><span class="string">"</span></span><br><span class="line"><span class="string">    Next</span></span><br><span class="line"><span class="string">    For Each ke In Dic.keys</span></span><br><span class="line"><span class="string">        MyFileName = Dir(ke &amp; "</span>*.doc<span class="string">")</span></span><br><span class="line"><span class="string">        Do While MyFileName &lt;&gt; "</span><span class="string">"</span></span><br><span class="line"><span class="string">            Did.Add (ke &amp; MyFileName), "</span><span class="string">"</span></span><br><span class="line"><span class="string">            MyFileName = Dir</span></span><br><span class="line"><span class="string">        Loop</span></span><br><span class="line"><span class="string">    Next</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Sheet1.Range("</span>D:I<span class="string">").ClearContents</span></span><br><span class="line"><span class="string">    Sheet1.[D1].Resize(Did.Count, 1) = WorksheetFunction.Transpose(Did.keys)</span></span><br><span class="line"><span class="string">End Sub</span></span><br></pre></td></tr></table></figure><h3 id="提取内容"><a href="#提取内容" class="headerlink" title="提取内容"></a>提取内容</h3><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> 管辖提取()</span><br><span class="line">    <span class="keyword">Dim</span> wdApp <span class="keyword">As</span> Word.Application</span><br><span class="line">    <span class="keyword">Dim</span> wddocument <span class="keyword">As</span> Word.Document</span><br><span class="line">    <span class="keyword">Dim</span> myExp1, myExp2, myExp3, myExp4, myExp5 <span class="keyword">As</span> RegExp</span><br><span class="line">    <span class="keyword">Dim</span> AllContent</span><br><span class="line">    Max_k = Application.CountA(Sheet1.Range(<span class="string">"D:D"</span>))</span><br><span class="line">    <span class="keyword">For</span> k = <span class="number">2</span> <span class="keyword">To</span> Max_k</span><br><span class="line">        file_ = Sheet1.Range(<span class="string">"D"</span> &amp; k)</span><br><span class="line">        <span class="keyword">Set</span> wdApp = <span class="keyword">New</span> Word.Application</span><br><span class="line">        <span class="keyword">Set</span> wddocument = wdApp.Documents.Open(file_)</span><br><span class="line">        <span class="keyword">With</span> wdApp</span><br><span class="line">            <span class="keyword">Set</span> myExp1 = <span class="keyword">New</span> RegExp</span><br><span class="line">            <span class="keyword">Set</span> myExp2 = <span class="keyword">New</span> RegExp</span><br><span class="line">            <span class="keyword">Set</span> myExp3 = <span class="keyword">New</span> RegExp</span><br><span class="line">            <span class="keyword">Set</span> myExp4 = <span class="keyword">New</span> RegExp</span><br><span class="line">            <span class="keyword">Set</span> myExp5 = <span class="keyword">New</span> RegExp</span><br><span class="line">            AllContent = wddocument.Content</span><br><span class="line">            <span class="keyword">With</span> myExp1 <span class="comment">'提取上诉人'</span></span><br><span class="line">                .Pattern = Sheet1.Range(<span class="string">"B1"</span>)</span><br><span class="line">                .<span class="keyword">Global</span> = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">Set</span> myMsg = .Execute(AllContent)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">For</span> <span class="keyword">Each</span> m <span class="keyword">In</span> myMsg</span><br><span class="line">                    Sheet1.Range(<span class="string">"E"</span> &amp; k) = <span class="keyword">Mid</span>(m, <span class="number">3</span>, (Len(m) - <span class="number">3</span>))</span><br><span class="line">                <span class="keyword">Next</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">With</span> myExp2 <span class="comment">'提取起诉'</span></span><br><span class="line">                .Pattern = Sheet1.Range(<span class="string">"B2"</span>)</span><br><span class="line">                .<span class="keyword">Global</span> = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">Set</span> myMsg = .Execute(AllContent)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">For</span> <span class="keyword">Each</span> m <span class="keyword">In</span> myMsg</span><br><span class="line">                    Sheet1.Range(<span class="string">"F"</span> &amp; k) = <span class="keyword">Mid</span>(m, <span class="number">6</span>, (Len(m) - <span class="number">10</span>))</span><br><span class="line">                <span class="keyword">Next</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">With</span> myExp3 <span class="comment">'提取上诉'</span></span><br><span class="line">                .Pattern = Sheet1.Range(<span class="string">"B3"</span>)</span><br><span class="line">                .<span class="keyword">Global</span> = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">Set</span> myMsg = .Execute(AllContent)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">For</span> <span class="keyword">Each</span> m <span class="keyword">In</span> myMsg</span><br><span class="line">                    Sheet1.Range(<span class="string">"G"</span> &amp; k) = m</span><br><span class="line">                <span class="keyword">Next</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line">             <span class="keyword">With</span> myExp4 <span class="comment">'提取案号'</span></span><br><span class="line">                .Pattern = Sheet1.Range(<span class="string">"B4"</span>)</span><br><span class="line">                .<span class="keyword">Global</span> = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">Set</span> myMsg = .Execute(AllContent)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">For</span> <span class="keyword">Each</span> m <span class="keyword">In</span> myMsg</span><br><span class="line">                    Sheet1.Range(<span class="string">"H"</span> &amp; k) = m</span><br><span class="line">                <span class="keyword">Next</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">With</span> myExp5 <span class="comment">'提取时间'</span></span><br><span class="line">                .Pattern = Sheet1.Range(<span class="string">"B5"</span>)</span><br><span class="line">                .<span class="keyword">Global</span> = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">Set</span> myMsg = .Execute(AllContent)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">For</span> <span class="keyword">Each</span> m <span class="keyword">In</span> myMsg</span><br><span class="line">                    Sheet1.Range(<span class="string">"I"</span> &amp; k) = m</span><br><span class="line">                <span class="keyword">Next</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">With</span> Show1</span><br><span class="line">                .Show <span class="number">0</span></span><br><span class="line">                .Caption = <span class="string">"正在提取……"</span></span><br><span class="line">                .Label1.Caption = <span class="string">"正在提取 "</span> &amp; (k - <span class="number">1</span>) &amp; <span class="string">"/"</span> &amp; (Max_k - <span class="number">1</span>)</span><br><span class="line">                .Label2.Caption = Sheet1.Range(<span class="string">"H"</span> &amp; k)</span><br><span class="line">                DoEvents</span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line">            .Documents.Close</span><br><span class="line">            .Quit</span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">        <span class="keyword">Set</span> wdApp = <span class="literal">Nothing</span></span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line">    Show1.Hide</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure><p>为直观了解提取和生成进度，需要添加窗体控件。 </p><p><img src="http://7rf2ax.com1.z0.glb.clouddn.com/%E6%8F%90%E5%8F%96%E7%94%9F%E6%88%902.jpg" alt="窗体控件" title="窗体控件"></p><h3 id="生成文件"><a href="#生成文件" class="headerlink" title="生成文件"></a>生成文件</h3><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> 管辖生成()</span><br><span class="line">    <span class="keyword">Dim</span> wdApp <span class="keyword">As</span> Word.Application</span><br><span class="line">    <span class="keyword">Dim</span> wddocument <span class="keyword">As</span> Word.Document</span><br><span class="line">    Max_k = Application.CountA(Sheet1.Range(<span class="string">"D:D"</span>))</span><br><span class="line">    <span class="keyword">If</span> (MsgBox(<span class="string">"确认生成？"</span>, vbYesNo)) = vbNo <span class="keyword">Then</span></span><br><span class="line">        Cancel = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">        <span class="keyword">For</span> k = <span class="number">2</span> <span class="keyword">To</span> Max_k</span><br><span class="line">            file_ = Sheet1.Range(<span class="string">"C1"</span>)</span><br><span class="line">            <span class="keyword">Set</span> wdApp = <span class="keyword">New</span> Word.Application</span><br><span class="line">            <span class="keyword">Set</span> wddocument = wdApp.Documents.Open(file_)</span><br><span class="line">            <span class="keyword">With</span> wdApp</span><br><span class="line">                wddocument.Content.Find.Execute findtext:=<span class="string">"NUM"</span>, ReplaceWith:=Range(<span class="string">"H"</span> &amp; k)</span><br><span class="line">                wddocument.Content.Find.Execute findtext:=<span class="string">"TIME"</span>, ReplaceWith:=Range(<span class="string">"I"</span> &amp; k)</span><br><span class="line">                wddocument.Content.Find.Execute findtext:=<span class="string">"QS"</span>, ReplaceWith:=Range(<span class="string">"F"</span> &amp; k), replace:=wdReplaceAll</span><br><span class="line">                wddocument.Content.Find.Execute findtext:=<span class="string">"SS"</span>, ReplaceWith:=Range(<span class="string">"E"</span> &amp; k) &amp; Range(<span class="string">"G"</span> &amp; k)</span><br><span class="line">                Filename = Sheet1.Range(<span class="string">"D1"</span>) &amp; Sheet1.Range(<span class="string">"H"</span> &amp; k) &amp; <span class="string">"管辖合议笔录"</span></span><br><span class="line">                .ActiveDocument.SaveAs Filename</span><br><span class="line">                <span class="keyword">With</span> Show1</span><br><span class="line">                    .Show <span class="number">0</span></span><br><span class="line">                    .Caption = <span class="string">"正在生成……"</span></span><br><span class="line">                    .Label1.Caption = <span class="string">"正在生成 "</span> &amp; (k - <span class="number">1</span>) &amp; <span class="string">"/"</span> &amp; (Max_k - <span class="number">1</span>)</span><br><span class="line">                    .Label2.Caption = Sheet1.Range(<span class="string">"H"</span> &amp; k) &amp; <span class="string">"管辖合议笔录.doc"</span></span><br><span class="line">                    DoEvents</span><br><span class="line">                <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">                .Documents.Close</span><br><span class="line">                .Quit</span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">            <span class="keyword">Set</span> wdApp = <span class="literal">Nothing</span></span><br><span class="line">        <span class="keyword">Next</span></span><br><span class="line">        Show1.Hide</span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;工作中一直需要根据一个Word文件内的内容提取后放到其他Word模板中整合为一个新的文件，数量一多就很烦，所以利用VBA写了一个工具，利用正
      
    
    </summary>
    
      <category term="VBA" scheme="http://www.zigma.cc/categories/VBA/"/>
    
    
      <category term="VBA" scheme="http://www.zigma.cc/tags/VBA/"/>
    
  </entry>
  
  <entry>
    <title>【VBA】VBA+正则表达式提取标题快速保存归档</title>
    <link href="http://www.zigma.cc/2017/08/26/%E3%80%90VBA%E3%80%91VBA+%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%8F%90%E5%8F%96%E6%A0%87%E9%A2%98%E5%BF%AB%E9%80%9F%E4%BF%9D%E5%AD%98%E5%BD%92%E6%A1%A3/"/>
    <id>http://www.zigma.cc/2017/08/26/【VBA】VBA+正则表达式提取标题快速保存归档/</id>
    <published>2017-08-26T15:05:35.000Z</published>
    <updated>2018-06-27T12:52:47.209Z</updated>
    
    <content type="html"><![CDATA[<p>今天快下班了同事找我提了个需求：归档目录太深，每次写完材料归档时需要点很久，且文件夹繁多，保存时要新建文件夹并重命名，Word文档保存时也需要命名。 </p><p>想了一下，可以靠Word宏配合正则表达式解决。 </p><p>思路：利用正则表达式提取正文中的案号，并将该案号作为归档文件夹和文件名。而且正好之前在Excel中试验过类似功能，只不过那个是提取案号后将Word另存为。</p><blockquote><p>注：需要在VBA编辑器工具→引用Microsoft VBScript Regular Expressions 5.5</p></blockquote><h2 id="Word代码如下："><a href="#Word代码如下：" class="headerlink" title="Word代码如下："></a>Word代码如下：</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> 快速保存()</span><br><span class="line">Path1 = <span class="string">"E:\" "</span>设置文件夹路径</span><br><span class="line">    <span class="keyword">Set</span> objshell = CreateObject(<span class="string">"Shell.Application"</span>) </span><br><span class="line">    <span class="keyword">Set</span> objFolder = objshell.browseForFolder(<span class="number">0</span>, <span class="string">"选择文件夹"</span>, <span class="number">0</span>, Path1)</span><br><span class="line">    <span class="keyword">If</span> <span class="keyword">Not</span> objFolder <span class="keyword">Is</span> <span class="literal">Nothing</span> <span class="keyword">Then</span> FolderPath = Path1 &amp; objFolder</span><br><span class="line"></span><br><span class="line">    <span class="keyword">Dim</span> myExp <span class="keyword">As</span> RegExp</span><br><span class="line">    <span class="keyword">Dim</span> AllContent</span><br><span class="line">    <span class="keyword">Set</span> myExp = <span class="keyword">New</span> RegExp</span><br><span class="line">    AllContent = ActiveDocument.Content</span><br><span class="line">    <span class="keyword">With</span> myExp  <span class="comment">'利用正则表达式提取案号以作为文件夹名和文件名'</span></span><br><span class="line">        .Pattern = <span class="string">"(（2|\(2).+?号"</span></span><br><span class="line">        .<span class="keyword">Global</span> = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">Set</span> myMsg = .Execute(AllContent)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">For</span> <span class="keyword">Each</span> m <span class="keyword">In</span> myMsg</span><br><span class="line">            filename_ = m</span><br><span class="line">        <span class="keyword">Next</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">    <span class="keyword">Set</span> wdApp = <span class="literal">Nothing</span></span><br><span class="line"></span><br><span class="line">    Path2 = FolderPath &amp; <span class="string">"\" &amp; filename_ "</span>判断是否已经存在文件</span><br><span class="line">    <span class="keyword">Set</span> FSO = CreateObject(<span class="string">"Scripting.FileSystemObject"</span>)</span><br><span class="line">    <span class="keyword">If</span> FSO.FolderExists(Path2) = <span class="literal">True</span> <span class="keyword">Then</span></span><br><span class="line">        <span class="keyword">If</span> (MsgBox(<span class="string">"已存在该文件，是否覆盖？"</span>, vbYesNo)) = vbNo <span class="keyword">Then</span></span><br><span class="line">            Cancel = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">GoTo</span> k</span><br><span class="line">        <span class="keyword">Else</span></span><br><span class="line">            <span class="keyword">GoTo</span> l</span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">        MkDir (FolderPath &amp; <span class="string">"\" &amp; filename_) "</span>不存在则创建文件夹</span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">l:</span><br><span class="line">    ActiveDocument.SaveAs FileName:=FolderPath &amp; <span class="string">"\" &amp; filename_ &amp; "</span>\<span class="string">" &amp; filename_</span></span><br><span class="line"><span class="string">k:</span></span><br><span class="line"><span class="string">End Sub</span></span><br></pre></td></tr></table></figure><p>2018-2-4日更新 进入2018年同事又提出要更改年份文件夹，因此修改了代码，保存到相应案号的年份中。</p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> 快速保存()</span><br><span class="line">    <span class="keyword">Dim</span> myExp <span class="keyword">As</span> RegExp <span class="comment">'利用正则表达式提取案号以作为文件夹名和文件名'</span></span><br><span class="line">    <span class="keyword">Dim</span> AllContent</span><br><span class="line">    <span class="keyword">Set</span> myExp = <span class="keyword">New</span> RegExp</span><br><span class="line">    AllContent = ActiveDocument.Content</span><br><span class="line">    <span class="keyword">With</span> myExp</span><br><span class="line">        .Pattern = <span class="string">"(（2|\(2).+?号"</span> <span class="comment">'正则表达式'</span></span><br><span class="line">        .<span class="keyword">Global</span> = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">Set</span> myMsg = .Execute(AllContent)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">For</span> <span class="keyword">Each</span> m <span class="keyword">In</span> myMsg</span><br><span class="line">            fileName_ = m</span><br><span class="line">        <span class="keyword">Next</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line">    Year_ = <span class="keyword">Mid</span>(fileName_, <span class="number">2</span>, <span class="number">4</span>) &amp; <span class="string">"年案件"</span></span><br><span class="line"></span><br><span class="line">    Path1 = <span class="string">"E:\" "</span>设置文件夹路径</span><br><span class="line">    <span class="keyword">Set</span> objshell = CreateObject(<span class="string">"Shell.Application"</span>) <span class="comment">'选择保存路径'</span></span><br><span class="line">    <span class="keyword">Set</span> objFolder = objshell.browseForFolder(<span class="number">0</span>, <span class="string">"选择文件夹"</span>, <span class="number">0</span>, Path1)</span><br><span class="line">    <span class="keyword">If</span> <span class="keyword">Not</span> objFolder <span class="keyword">Is</span> <span class="literal">Nothing</span> <span class="keyword">Then</span> FolderPath = Path1 &amp; objFolder <span class="keyword">Else</span> <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line">    Path2 = FolderPath &amp; <span class="string">"\" &amp; Year_ "</span>定义年份及案号命名的文件夹路径</span><br><span class="line">    Path3 = FolderPath &amp; <span class="string">"\" &amp; Year_ &amp; "</span>\<span class="string">" &amp; fileName_</span></span><br><span class="line"><span class="string">    Set FSO = CreateObject("</span>Scripting.FileSystemObject<span class="string">")</span></span><br><span class="line"><span class="string">    If FSO.FolderExists(Path2) = False Then</span></span><br><span class="line"><span class="string">        MkDir (FolderPath &amp; "</span>\<span class="string">" &amp; Year_) "</span>不存在则创建文件夹</span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">If</span> FSO.FolderExists(Path3) = <span class="literal">True</span> <span class="keyword">Then</span></span><br><span class="line">        <span class="keyword">If</span> (MsgBox(<span class="string">"已存在该文件，是否覆盖？"</span>, vbYesNo)) = vbNo <span class="keyword">Then</span></span><br><span class="line">            Cancel = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">        <span class="keyword">Else</span></span><br><span class="line">            <span class="keyword">GoTo</span> l</span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">    MkDir (FolderPath &amp; <span class="string">"\" &amp; Year_ &amp; "</span>\<span class="string">" &amp; fileName_)</span></span><br><span class="line"><span class="string">    End If</span></span><br><span class="line"><span class="string">l:</span></span><br><span class="line"><span class="string">    ActiveDocument.SaveAs FileName:=FolderPath &amp; "</span>\<span class="string">" &amp; Year_ &amp; "</span>\<span class="string">" &amp; fileName_ &amp; "</span>\<span class="string">" &amp; fileName_ "</span>另存为重命名文件</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure><p>2018-2-5日更新 </p><p>发现每次需要进入宏来修改路径太麻烦，所以又更新了代码，在C盘生成一个保存路径的TXT文件作为配置读取，并且无需再在使用前引用Microsoft VBScript Regular Expressions 5.5。</p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> 设置保存路径()</span><br><span class="line">    <span class="keyword">Dim</span> sFile, sFile_, sOpen <span class="keyword">As</span> <span class="built_in">Object</span>, Fso <span class="keyword">As</span> <span class="built_in">Object</span></span><br><span class="line">    <span class="keyword">Dim</span> FPath <span class="keyword">As</span> <span class="built_in">String</span></span><br><span class="line">    <span class="keyword">Set</span> Fso = CreateObject(<span class="string">"Scripting.FileSystemObject"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">If</span> Fso.FileExists(<span class="string">"C:\AutoSave\AutoSave.txt"</span>) = <span class="literal">False</span> <span class="keyword">Then</span> <span class="string">"判断是否存在设置文件"</span></span><br><span class="line">        MkDir (<span class="string">"C:\AutoSave\") "</span>创建设置文件夹及文件</span><br><span class="line">        <span class="keyword">Set</span> sFile = Fso.CreateTextFile(<span class="string">"C:\AutoSave\AutoSave.txt"</span>, <span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">Set</span> sFile_ = Fso.CreateTextFile(<span class="string">"C:\AutoSave\自动保存宏设置文件夹，勿删.txt"</span>, <span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">Set</span> sFile = <span class="literal">Nothing</span></span><br><span class="line">        <span class="keyword">Set</span> sFile_ = <span class="literal">Nothing</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Set</span> objshell = CreateObject(<span class="string">"Shell.Application"</span>) <span class="comment">'设置保存路径'</span></span><br><span class="line">    <span class="keyword">Set</span> objFolder = objshell.browseForFolder(<span class="number">0</span>, <span class="string">"请选择保存路径"</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">If</span> <span class="keyword">Not</span> objFolder <span class="keyword">Is</span> <span class="literal">Nothing</span> <span class="keyword">Then</span> FPath = objFolder.self.Path <span class="keyword">Else</span> <span class="keyword">Exit</span> <span class="keyword">Sub</span> <span class="comment">'必要！判断是否取消保存'</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Set</span> sOpen = Fso.OpenTextFile(<span class="string">"C:\AutoSave\AutoSave.txt"</span>, <span class="number">2</span>, <span class="number">0</span>) <span class="comment">'写入保存的路径'</span></span><br><span class="line">    <span class="keyword">If</span> len(FPath) &lt;= <span class="number">3</span> <span class="keyword">then</span> <span class="comment">'判断是否选取了盘符根目录'</span></span><br><span class="line">        sOpen.Write FPath</span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">        sOpen.Write FPath &amp; <span class="string">"\" "</span>写入设置的路径</span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">if</span></span><br><span class="line">    sOpen.Close</span><br><span class="line"></span><br><span class="line">    <span class="keyword">Set</span> Fso = <span class="literal">Nothing</span></span><br><span class="line">    <span class="keyword">Set</span> sOpen = <span class="literal">Nothing</span></span><br><span class="line">    <span class="keyword">Set</span> objshell = <span class="literal">Nothing</span></span><br><span class="line">    <span class="keyword">Set</span> objFolder = <span class="literal">Nothing</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> 快速保存()</span><br><span class="line">    <span class="keyword">Dim</span> sFile, sFile_, sOpen <span class="keyword">As</span> <span class="built_in">Object</span>, Fso <span class="keyword">As</span> <span class="built_in">Object</span></span><br><span class="line">    <span class="keyword">Dim</span> FPath <span class="keyword">As</span> <span class="built_in">String</span></span><br><span class="line">    <span class="keyword">Dim</span> myExp <span class="keyword">As</span> RegExp <span class="comment">'利用正则表达式提取案号以作为文件夹名和文件名'</span></span><br><span class="line">    <span class="keyword">Dim</span> AllContent</span><br><span class="line"></span><br><span class="line">    <span class="keyword">Set</span> Fso = CreateObject(<span class="string">"Scripting.FileSystemObject"</span>)</span><br><span class="line">    <span class="keyword">Set</span> objshell = CreateObject(<span class="string">"Shell.Application"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">If</span> Fso.FileExists(<span class="string">"C:\AutoSave\AutoSave.txt"</span>) = <span class="literal">False</span> <span class="keyword">Then</span> <span class="comment">'判断是否存在设置文件'</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">If</span> (MsgBox(<span class="string">"未设置归档路径，是否设置？"</span>, vbYesNo)) = vbNo <span class="keyword">Then</span></span><br><span class="line">            Cancel = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">        <span class="keyword">Else</span></span><br><span class="line">            <span class="keyword">Set</span> objFolder = objshell.browseForFolder(<span class="number">0</span>, <span class="string">"请选择保存路径"</span>, <span class="number">0</span>, <span class="number">0</span>) <span class="comment">'设置保存路径'</span></span><br><span class="line">            <span class="keyword">If</span> <span class="keyword">Not</span> objFolder <span class="keyword">Is</span> <span class="literal">Nothing</span> <span class="keyword">Then</span> FPath = objFolder.self.Path <span class="keyword">Else</span> <span class="keyword">Exit</span> <span class="keyword">Sub</span> <span class="comment">'必要！判断是否取消设置'</span></span><br><span class="line"></span><br><span class="line">            MkDir (<span class="string">"C:\AutoSave\") "</span>创建设置文件夹及文件</span><br><span class="line">            <span class="keyword">Set</span> sFile = Fso.CreateTextFile(<span class="string">"C:\AutoSave\AutoSave.txt"</span>, <span class="literal">True</span>)</span><br><span class="line">            <span class="keyword">Set</span> sFile_ = Fso.CreateTextFile(<span class="string">"C:\AutoSave\自动保存宏设置文件夹，勿删.txt"</span>, <span class="literal">True</span>)</span><br><span class="line">            <span class="keyword">Set</span> sFile = <span class="literal">Nothing</span></span><br><span class="line">            <span class="keyword">Set</span> sFile_ = <span class="literal">Nothing</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">Set</span> sOpen = Fso.OpenTextFile(<span class="string">"C:\AutoSave\AutoSave.txt"</span>, <span class="number">2</span>, <span class="number">0</span>) </span><br><span class="line">            <span class="keyword">If</span> len(FPath) &lt;= <span class="number">3</span> <span class="keyword">then</span> <span class="comment">'判断是否选取了盘符根目录'</span></span><br><span class="line">                sOpen.Write FPath</span><br><span class="line">            <span class="keyword">Else</span></span><br><span class="line">                sOpen.Write FPath &amp; <span class="string">"\" "</span>写入设置的路径</span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">if</span></span><br><span class="line">            sOpen.Close</span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">Set</span> sOpen = <span class="literal">Nothing</span></span><br><span class="line">        <span class="keyword">Set</span> objFolder = <span class="literal">Nothing</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span>​</span><br></pre></td></tr></table></figure><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">Set</span> myExp = <span class="keyword">New</span> RegExp</span><br><span class="line">    AllContent = ActiveDocument.Content</span><br><span class="line">    <span class="keyword">With</span> myExp</span><br><span class="line">        .Pattern = <span class="string">"(（2|\(2).+?号"</span> <span class="comment">'正则表达式'</span></span><br><span class="line">        .<span class="keyword">Global</span> = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">Set</span> myMsg = .Execute(AllContent)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">For</span> <span class="keyword">Each</span> m <span class="keyword">In</span> myMsg</span><br><span class="line">            fileName_ = m</span><br><span class="line">        <span class="keyword">Next</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line">    Year_ = <span class="keyword">Mid</span>(fileName_, <span class="number">2</span>, <span class="number">4</span>) &amp; <span class="string">"年案件"</span> <span class="comment">'提取年度，并依据年度分类文件'</span></span><br><span class="line"></span><br><span class="line">    Open <span class="string">"C:\AutoSave\AutoSave.txt"</span> <span class="keyword">For</span> Input <span class="keyword">As</span> <span class="meta">#1</span></span><br><span class="line">    Line Input <span class="meta">#1, Path1</span></span><br><span class="line">    Close <span class="meta">#1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Set</span> objFolder = objshell.browseForFolder(<span class="number">0</span>, <span class="string">"请选择案件类型文件夹"</span>, <span class="number">0</span>, Path1) <span class="comment">'选择保存路径'</span></span><br><span class="line">    <span class="keyword">If</span> <span class="keyword">Not</span> objFolder <span class="keyword">Is</span> <span class="literal">Nothing</span> <span class="keyword">Then</span> FolderPath = objFolder.self.Path <span class="keyword">Else</span> <span class="keyword">Exit</span> <span class="keyword">Sub</span> <span class="comment">'必要！判断是否取消保存'</span></span><br><span class="line"></span><br><span class="line">    Path2 = FolderPath &amp; <span class="string">"\" &amp; Year_ "</span>定义年份及案号命名的文件夹路径</span><br><span class="line">    Path3 = FolderPath &amp; <span class="string">"\" &amp; Year_ &amp; "</span>\<span class="string">" &amp; fileName_</span></span><br><span class="line"><span class="string">    If Fso.FolderExists(Path2) = False Then</span></span><br><span class="line"><span class="string">        MkDir (FolderPath &amp; "</span>\<span class="string">" &amp; Year_) "</span>创建年份的文件夹</span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">If</span> Fso.FolderExists(Path3) = <span class="literal">True</span> <span class="keyword">Then</span></span><br><span class="line">        <span class="keyword">If</span> (MsgBox(<span class="string">"已存在该文件，是否覆盖？"</span>, vbYesNo)) = vbNo <span class="keyword">Then</span></span><br><span class="line">            Cancel = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">        <span class="keyword">Else</span></span><br><span class="line">            <span class="keyword">GoTo</span> l</span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">        MkDir (FolderPath &amp; <span class="string">"\" &amp; Year_ &amp; "</span>\<span class="string">" &amp; fileName_)</span></span><br><span class="line"><span class="string">    End If</span></span><br><span class="line"><span class="string">l:</span></span><br><span class="line"><span class="string">    ActiveDocument.SaveAs FileName:=FolderPath &amp; "</span>\<span class="string">" &amp; Year_ &amp; "</span>\<span class="string">" &amp; fileName_ &amp; "</span>\<span class="string">" &amp; fileName_ "</span>另存为重命名文件</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure><p>​<br>​    </p><p>Excel中则需要调用Word.Application，但是思路还是和Word中一样。</p><h2 id="代码如下："><a href="#代码如下：" class="headerlink" title="代码如下："></a>代码如下：</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> test()</span><br><span class="line">    <span class="keyword">Dim</span> wdApp <span class="keyword">As</span> Word.Application</span><br><span class="line">    <span class="keyword">Dim</span> wddocument <span class="keyword">As</span> Word.document</span><br><span class="line">    <span class="keyword">Dim</span> myExp <span class="keyword">As</span> RegExp</span><br><span class="line">    <span class="keyword">Dim</span> AllContent</span><br><span class="line">    <span class="keyword">For</span> k = <span class="number">2</span> <span class="keyword">To</span> Application.CountA(Sheet1.Range(<span class="string">"D:D"</span>))</span><br><span class="line">        file_ = Sheet1.Range(<span class="string">"D"</span> &amp; k)</span><br><span class="line">        <span class="keyword">Set</span> wdApp = <span class="keyword">New</span> Word.Application</span><br><span class="line">        <span class="keyword">Set</span> wddocument = wdApp.Documents.Open(file_)</span><br><span class="line">        <span class="keyword">With</span> wdApp</span><br><span class="line">            <span class="keyword">Set</span> myExp = <span class="keyword">New</span> RegExp</span><br><span class="line">            AllContent = wddocument.Content</span><br><span class="line">            <span class="keyword">With</span> myExp</span><br><span class="line">                .Pattern = Sheet1.Range(<span class="string">"B1"</span>)</span><br><span class="line">                .<span class="keyword">Global</span> = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">Set</span> myMsg = .Execute(AllContent)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">For</span> <span class="keyword">Each</span> m <span class="keyword">In</span> myMsg</span><br><span class="line">                    Sheet1.Range(<span class="string">"E"</span> &amp; k) = m</span><br><span class="line">                <span class="keyword">Next</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">            .Documents.Close</span><br><span class="line">            .Quit</span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">        <span class="keyword">Set</span> wdApp = <span class="literal">Nothing</span></span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;今天快下班了同事找我提了个需求：归档目录太深，每次写完材料归档时需要点很久，且文件夹繁多，保存时要新建文件夹并重命名，Word文档保存时也需要命名。 &lt;/p&gt;
&lt;p&gt;想了一下，可以靠Word宏配合正则表达式解决。 &lt;/p&gt;
&lt;p&gt;思路：利用正则表达式提取正文中的案号，并将该
      
    
    </summary>
    
      <category term="VBA" scheme="http://www.zigma.cc/categories/VBA/"/>
    
    
      <category term="VBA" scheme="http://www.zigma.cc/tags/VBA/"/>
    
  </entry>
  
  <entry>
    <title>民事管辖案件中关于接受货币方的理解</title>
    <link href="http://www.zigma.cc/2017/08/16/%E6%B0%91%E4%BA%8B%E7%AE%A1%E8%BE%96%E6%A1%88%E4%BB%B6%E4%B8%AD%E5%85%B3%E4%BA%8E%E6%8E%A5%E5%8F%97%E8%B4%A7%E5%B8%81%E6%96%B9%E7%9A%84%E7%90%86%E8%A7%A3/"/>
    <id>http://www.zigma.cc/2017/08/16/民事管辖案件中关于接受货币方的理解/</id>
    <published>2017-08-16T15:03:17.000Z</published>
    <updated>2018-06-26T13:55:08.214Z</updated>
    
    <content type="html"><![CDATA[<p>今天校对文书时，发现一审中原告因民间借贷纠纷起诉被告，要求被告履行还款义务，被告提起管辖异议，被驳回后又提起管辖异议上诉。 </p><p>本院进行审查后，裁定驳回了上诉人的上诉申请，维持原裁定，理由是双方没有约定借款合同履行地，而根据《最高人民法院关于适用&lt;中华人民共和国民事诉讼法&gt;的解释》第十八条之规定被上诉人作为接受货币的一方，被上诉人所在地法院拥有管辖权。 </p><p>令人不解的是，民间借贷中拥有两个不同时段、互相对立的接受货币方，那么如何进行确定哪一个接受货币方所在辖区法院进行管辖？ </p><p>1、借贷合同作为诺成性合同，在出借方未履行出借义务之前，借款人作为接受货币方，理应由借款人所在地法院进行管辖。</p><p> 2、出借人履行出借义务后，借款到期后借款人需要履行还款义务，出借人转换为接受货币方，此时理应由出借人所在地法院进行管辖。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;今天校对文书时，发现一审中原告因民间借贷纠纷起诉被告，要求被告履行还款义务，被告提起管辖异议，被驳回后又提起管辖异议上诉。 &lt;/p&gt;
&lt;p&gt;本院进行审查后，裁定驳回了上诉人的上诉申请，维持原裁定，理由是双方没有约定借款合同履行地，而根据《最高人民法院关于适用&amp;lt;中华人民
      
    
    </summary>
    
      <category term="工作" scheme="http://www.zigma.cc/categories/%E5%B7%A5%E4%BD%9C/"/>
    
    
      <category term="合同" scheme="http://www.zigma.cc/tags/%E5%90%88%E5%90%8C/"/>
    
      <category term="民间借贷" scheme="http://www.zigma.cc/tags/%E6%B0%91%E9%97%B4%E5%80%9F%E8%B4%B7/"/>
    
  </entry>
  
  <entry>
    <title>WordPress升级优化</title>
    <link href="http://www.zigma.cc/2017/08/16/WordPress%E5%8D%87%E7%BA%A7%E4%BC%98%E5%8C%96/"/>
    <id>http://www.zigma.cc/2017/08/16/WordPress升级优化/</id>
    <published>2017-08-16T15:02:49.000Z</published>
    <updated>2018-06-26T13:55:37.072Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1、禁用修订版本功能"><a href="#1、禁用修订版本功能" class="headerlink" title="1、禁用修订版本功能"></a>1、禁用修订版本功能</h2><p>在wp-config.php中插入</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="string">'WP_POST_REVISIONS'</span>,<span class="keyword">false</span>);</span><br></pre></td></tr></table></figure><p>如果在最后插入是无效的。</p><h2 id="2、首页阅读全文功能"><a href="#2、首页阅读全文功能" class="headerlink" title="2、首页阅读全文功能"></a>2、首页阅读全文功能</h2><p>编辑主题文件夹中index.php 将</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> the_content(); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>修改为</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> the_excerpt() <span class="meta">?&gt;</span></span><br><span class="line">&lt;a href=<span class="string">"&lt;?php the_permalink(); ?&gt;"</span>&gt;阅读全文…&lt;/a&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;1、禁用修订版本功能&quot;&gt;&lt;a href=&quot;#1、禁用修订版本功能&quot; class=&quot;headerlink&quot; title=&quot;1、禁用修订版本功能&quot;&gt;&lt;/a&gt;1、禁用修订版本功能&lt;/h2&gt;&lt;p&gt;在wp-config.php中插入&lt;/p&gt;
&lt;figure class=&quot;h
      
    
    </summary>
    
      <category term="Wordpress" scheme="http://www.zigma.cc/categories/Wordpress/"/>
    
    
      <category term="Wordpress" scheme="http://www.zigma.cc/tags/Wordpress/"/>
    
  </entry>
  
  <entry>
    <title>CentOS监控进程状态并自动重启</title>
    <link href="http://www.zigma.cc/2017/08/15/CentOS%E7%9B%91%E6%8E%A7%E8%BF%9B%E7%A8%8B%E7%8A%B6%E6%80%81%E5%B9%B6%E8%87%AA%E5%8A%A8%E9%87%8D%E5%90%AF/"/>
    <id>http://www.zigma.cc/2017/08/15/CentOS监控进程状态并自动重启/</id>
    <published>2017-08-15T15:00:43.000Z</published>
    <updated>2018-06-26T13:55:56.252Z</updated>
    
    <content type="html"><![CDATA[<p>在CentOS系统中利用Crontab监控进程是否被结束并自动重启。 附加每天凌晨4点自动重启服务器。</p><h3 id="1-编辑Crontab"><a href="#1-编辑Crontab" class="headerlink" title="1. 编辑Crontab"></a>1. 编辑Crontab</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br></pre></td></tr></table></figure><h3 id="2-按i进行编辑"><a href="#2-按i进行编辑" class="headerlink" title="2. 按i进行编辑"></a>2. 按i进行编辑</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*/1 * * * * /root/monitor.sh     # 每分钟运行一遍monitor.sh脚本</span><br><span class="line">0 5 * * * /sbin/reboot           # 每天凌晨5点自动重启服务器</span><br></pre></td></tr></table></figure><h3 id="3-root文件夹下创建monitor-sh脚本"><a href="#3-root文件夹下创建monitor-sh脚本" class="headerlink" title="3. root文件夹下创建monitor.sh脚本"></a>3. root文件夹下创建monitor.sh脚本</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>! /bin/sh</span><br><span class="line"></span><br><span class="line">host_dir=`echo ~`                         # 当前用户根目录  </span><br><span class="line">proc_name="net_speeder"                   # 进程名  </span><br><span class="line">file_name="/root/log/netspeed.log"        # 日志文件</span><br><span class="line">pid=0  </span><br><span class="line"></span><br><span class="line">proc_num()                                # 计算进程数  </span><br><span class="line">&#123;  </span><br><span class="line">    num=`ps -ef | grep $proc_name | grep -v grep | wc -l`  </span><br><span class="line">    return $num  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line">proc_id()                                 # 进程号  </span><br><span class="line">&#123;  </span><br><span class="line">    pid=`ps -ef | grep $proc_name | grep -v grep | awk '&#123;print $2&#125;'`  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line">proc_num  </span><br><span class="line">number=$?  </span><br><span class="line">if [ $number -eq 0 ]                      # 判断进程是否存在  </span><br><span class="line">then  </span><br><span class="line">    ~/net-speeder-master/net_speeder venet0 "tcp src port 443" &gt;/dev/null 2&gt;&amp;1 &amp;                         # 重启进程的命令</span><br><span class="line">    proc_id                               # 获取新进程号</span><br><span class="line">    echo $&#123;pid&#125;, `date` &gt;&gt; $host_dir$file_name    # 将新进程号和重启时间记录</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><h3 id="4-赋予脚本执行权限"><a href="#4-赋予脚本执行权限" class="headerlink" title="4. 赋予脚本执行权限"></a>4. 赋予脚本执行权限</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 777 /root/monitor.sh</span><br></pre></td></tr></table></figure><h3 id="5-添加log文件夹及log文件并赋予权限"><a href="#5-添加log文件夹及log文件并赋予权限" class="headerlink" title="5. 添加log文件夹及log文件并赋予权限"></a>5. 添加log文件夹及log文件并赋予权限</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir 777 /root/log</span><br><span class="line">touch /root/log/netspeed.log create file</span><br><span class="line">chmod 646 /root/log/netspeed.log</span><br></pre></td></tr></table></figure><h3 id="6-重启服务器以应用更改"><a href="#6-重启服务器以应用更改" class="headerlink" title="6. 重启服务器以应用更改"></a>6. 重启服务器以应用更改</h3><h3 id="7-重启后有可能出现crond进程没有运行的问题，需要在rc-local增加crond随系统启动"><a href="#7-重启后有可能出现crond进程没有运行的问题，需要在rc-local增加crond随系统启动" class="headerlink" title="7. 重启后有可能出现crond进程没有运行的问题，需要在rc.local增加crond随系统启动"></a>7. 重启后有可能出现crond进程没有运行的问题，需要在rc.local增加crond随系统启动</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/rc.local</span><br></pre></td></tr></table></figure><p>键入</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup /etc/init.d/crond restart</span><br></pre></td></tr></table></figure><p>利用:wq命令保存。</p><h3 id="8-设置每次重启后清除log文件"><a href="#8-设置每次重启后清除log文件" class="headerlink" title="8. 设置每次重启后清除log文件"></a>8. 设置每次重启后清除log文件</h3><p>在步骤7中键入</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup echo '' &gt; /root/log/netspeed.log</span><br></pre></td></tr></table></figure><h3 id="9-需要删除文件夹或文件"><a href="#9-需要删除文件夹或文件" class="headerlink" title="9. 需要删除文件夹或文件"></a>9. 需要删除文件夹或文件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm -rf /root/log/netspeed.log</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在CentOS系统中利用Crontab监控进程是否被结束并自动重启。 附加每天凌晨4点自动重启服务器。&lt;/p&gt;
&lt;h3 id=&quot;1-编辑Crontab&quot;&gt;&lt;a href=&quot;#1-编辑Crontab&quot; class=&quot;headerlink&quot; title=&quot;1. 编辑Cronta
      
    
    </summary>
    
      <category term="VPS" scheme="http://www.zigma.cc/categories/VPS/"/>
    
    
      <category term="CentOS" scheme="http://www.zigma.cc/tags/CentOS/"/>
    
      <category term="VPS" scheme="http://www.zigma.cc/tags/VPS/"/>
    
  </entry>
  
</feed>
